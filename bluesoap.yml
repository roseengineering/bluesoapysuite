---
  - set_fact:
      fs_path: "{{ fs_path | default('/srv') }}"

  # output directory

  - become: yes
    file: path={{ fs_path }} state=directory owner={{ user }} group={{ user }}

  # bluezero / mqtt

  - become: yes
    apt:
      name:
      - python3-dbus

  - become: yes
    pip:
      name:
      - bluezero
      - paho-mqtt

  - become: yes
    copy:
      dest: /etc/dbus-1/system.d/ukBaz.bluezero.conf 
      content: |
        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE busconfig PUBLIC 
         "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
         "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
        <busconfig>
          <policy context="default">
            <allow own="ukBaz.bluezero"/>
            <allow send_destination="ukBaz.bluezero"
                   send_interface="org.freedesktop.DBus.Introspectable"/>
            <allow send_type="method_call" log="true"/>
          </policy>
        </busconfig>

  # bluesoapy

  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqproxy
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCmZyb20gYmx1ZXplcm8gaW1wb3J0IHBlcmlw
        aGVyYWwKClVBUlRfU0VSSVZDRSA9ICc2RTQwMDAwMS1CNUEzLUYzOTMtRTBB
        OS1FNTBFMjREQ0NBOUUnClJYX0NIQVJBQ1RFUklTVElDID0gJzZFNDAwMDAy
        LUI1QTMtRjM5My1FMEE5LUU1MEUyNERDQ0E5RScKVFhfQ0hBUkFDVEVSSVNU
        SUMgPSAnNkU0MDAwMDMtQjVBMy1GMzkzLUUwQTktRTUwRTI0RENDQTlFJwoK
        Y2xhc3MgVWFydFNlcnZpY2U6CiAgICBkZWYgX19pbml0X18oc2VsZiwgb25y
        ZWFkLCBhbGlhcz0nUlBpX1VBUlQnKToKICAgICAgICBzZWxmLm9ucmVhZCA9
        IG9ucmVhZAogICAgICAgIHNlbGYuYXBwID0gcGVyaXBoZXJhbC5BcHBsaWNh
        dGlvbigpCiAgICAgICAgc2VsZi5ibGVfdWFydCA9IHBlcmlwaGVyYWwuU2Vy
        dmljZShVQVJUX1NFUklWQ0UsIFRydWUpCiAgICAgICAgc2VsZi5yeF91YXJ0
        ID0gcGVyaXBoZXJhbC5DaGFyYWN0ZXJpc3RpYyhSWF9DSEFSQUNURVJJU1RJ
        QywKICAgICAgICAgICAgWyd3cml0ZScsICd3cml0ZS13aXRob3V0LXJlc3Bv
        bnNlJ10sIHNlbGYuYmxlX3VhcnQpCiAgICAgICAgc2VsZi50eF91YXJ0ID0g
        cGVyaXBoZXJhbC5DaGFyYWN0ZXJpc3RpYyhUWF9DSEFSQUNURVJJU1RJQywK
        ICAgICAgICAgICAgWydub3RpZnknXSwgc2VsZi5ibGVfdWFydCkKICAgICAg
        ICBzZWxmLnJ4X3VhcnQuYWRkX3dyaXRlX2V2ZW50KHNlbGYudWFydF9wcmlu
        dCkKICAgICAgICBzZWxmLmJsZV91YXJ0LmFkZF9jaGFyYWN0ZXJpc3RpYyhz
        ZWxmLnJ4X3VhcnQpCiAgICAgICAgc2VsZi5ibGVfdWFydC5hZGRfY2hhcmFj
        dGVyaXN0aWMoc2VsZi50eF91YXJ0KQogICAgICAgIHNlbGYuYXBwLmFkZF9z
        ZXJ2aWNlKHNlbGYuYmxlX3VhcnQpCiAgICAgICAgc2VsZi5hcHAuZG9uZ2xl
        LmFsaWFzID0gYWxpYXMKICAgIGRlZiB1YXJ0X3ByaW50KHNlbGYsIGRhdGEp
        OgogICAgICAgIHZhbHVlID0gJycuam9pbihjaHIobGV0dGVyKSBmb3IgbGV0
        dGVyIGluIGRhdGEpCiAgICAgICAgc2VsZi5vbnJlYWQodmFsdWUpCiAgICBk
        ZWYgc3RhcnQoc2VsZik6CiAgICAgICAgc2VsZi5hcHAuc3RhcnQoKQoKIyMj
        IyMjIyMjIyMjIyMjIyMjIyMjIwoKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBw
        YWhvLm1xdHQuY2xpZW50IGFzIG1xdHQKZnJvbSBkYXRldGltZSBpbXBvcnQg
        ZGF0ZXRpbWUKCnBhcnNlciA9IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKAog
        ICAgZm9ybWF0dGVyX2NsYXNzPWFyZ3BhcnNlLkFyZ3VtZW50RGVmYXVsdHNI
        ZWxwRm9ybWF0dGVyKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWJyb2tlciIs
        IGRlZmF1bHQ9IjEyNy4wLjAuMSIsIGhlbHA9J2Jyb2tlciBob3N0JykKcGFy
        c2VyLmFkZF9hcmd1bWVudCgiLS1wb3J0IiwgZGVmYXVsdD0xODgzLCBoZWxw
        PSdicm9rZXIgcG9ydCcpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0ta2VlcGFs
        aXZlIiwgZGVmYXVsdD02MCwgaGVscD0nYnJva2VyIGtlZXAgYWxpdmUnKQpw
        YXJzZXIuYWRkX2FyZ3VtZW50KCItLXRvcGljIiwgZGVmYXVsdD0iZi90eCIs
        IGhlbHA9J2NvbW1hbmQgdG9waWMnKQoKZGVmIG1haW4oKToKICAgIGRlZiBv
        bmNvbm5lY3QoY2xpZW50LCB1c2VyZGF0YSwgZmxhZ3MsIHJjKToKICAgICAg
        ICBjbGllbnQuc3Vic2NyaWJlKCcjJykKICAgIGRlZiBvbndyaXRlKHZhbHVl
        KToKICAgICAgICBjbGllbnQucHVibGlzaChhcmdzLnRvcGljLCB2YWx1ZSkK
        ICAgIGRlZiBvbm1lc3NhZ2UoY2xpZW50LCB1c2VyZGF0YSwgbXNnKToKICAg
        ICAgICBwYXlsb2FkID0gbXNnLnBheWxvYWQuZGVjb2RlKCdsYXRpbicpCiAg
        ICAgICAgdHMgPSBkYXRldGltZS5ub3coKS5zdHJmdGltZSgnJUg6JU06JVMn
        KQogICAgICAgIHVhcnQudHhfdWFydC5zZW5kX25vdGlmeV9ldmVudChmJ3t0
        c30ge21zZy50b3BpY30ge3BheWxvYWR9JykKICAgIHVhcnQgPSBVYXJ0U2Vy
        dmljZShvbndyaXRlKQogICAgY2xpZW50ID0gbXF0dC5DbGllbnQoKQogICAg
        Y2xpZW50Lm9uX2Nvbm5lY3QgPSBvbmNvbm5lY3QKICAgIGNsaWVudC5vbl9t
        ZXNzYWdlID0gb25tZXNzYWdlCiAgICBjbGllbnQuY29ubmVjdChhcmdzLmJy
        b2tlciwgYXJncy5wb3J0LCBhcmdzLmtlZXBhbGl2ZSkKICAgIGNsaWVudC5s
        b29wX3N0YXJ0KCkKICAgIHVhcnQuc3RhcnQoKQoKaWYgX19uYW1lX18gPT0g
        J19fbWFpbl9fJzoKICAgICMgcHJveHkgYmxlIHVhcnQgdG8gbXF0dCBicm9r
        ZXIKICAgICMgdGhpcyBuZWVkcyB0byBydW4gYXMgcm9vdAogICAgYXJncyA9
        IHBhcnNlci5wYXJzZV9hcmdzKCkKICAgIG1haW4oKQoK


  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqsoapy
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgb3MsIHN5cywgdGltZQppbXBv
        cnQgc3RydWN0CmltcG9ydCBhcmdwYXJzZQppbXBvcnQgbnVtcHkgYXMgbnAK
        aW1wb3J0IHBhaG8ubXF0dC5jbGllbnQgYXMgbXF0dAppbXBvcnQgU29hcHlT
        RFIKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKZnJvbSBTb2FweVNE
        UiBpbXBvcnQgU09BUFlfU0RSX1JYLCBTT0FQWV9TRFJfQ0YzMgoKcmVzdGFy
        dF9zZWNvbmRzID0gMTAKCnBhcnNlciA9IGFyZ3BhcnNlLkFyZ3VtZW50UGFy
        c2VyKAogICAgZm9ybWF0dGVyX2NsYXNzPWFyZ3BhcnNlLkFyZ3VtZW50RGVm
        YXVsdHNIZWxwRm9ybWF0dGVyKQoKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1i
        cm9rZXIiLCBkZWZhdWx0PSIxMjcuMC4wLjEiLCBoZWxwPSdicm9rZXIgaG9z
        dCcpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcG9ydCIsIGRlZmF1bHQ9MTg4
        MywgaGVscD0nYnJva2VyIHBvcnQnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCIt
        LWtlZXBhbGl2ZSIsIGRlZmF1bHQ9NjAsIGhlbHA9J2Jyb2tlciBrZWVwYWxp
        dmUgaW4gc2Vjb25kcycpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tdG9waWMi
        LCBkZWZhdWx0PSJmL3R4IiwgaGVscD0nbXF0dCB0b3BpYyBmb3IgY29tbWFu
        ZCcpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcHBzLXRvcGljIiwgZGVmYXVs
        dD0icHBzIiwgaGVscD0nbXF0dCB0b3BpYyBmb3IgZ3BzIHRpbWUnKQpwYXJz
        ZXIuYWRkX2FyZ3VtZW50KCItLWRyaXZlciIsIGhlbHA9J25hbWUgb2YgZHJp
        dmVyJykKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1wYWNrZXQtc2l6ZSIsIGRl
        ZmF1bHQ9MTAyNCwgaGVscD0ncGFja2V0IHNpemUnKQpwYXJzZXIuYWRkX2Fy
        Z3VtZW50KCItLWZyZXEiLCB0eXBlPW5wLmZsb2F0LCBoZWxwPSJjZW50ZXIg
        ZnJlcXVlbmN5IGluIGhlcnR6IikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1y
        YXRlIiwgdHlwZT1ucC5mbG9hdCwgaGVscD0ic2FtcGxlIHJhdGUgaW4gaGVy
        dHoiKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWdhaW4iLCB0eXBlPW5wLmZs
        b2F0LCBoZWxwPSJmcm9udCBlbmQgZ2FpbiBpbiBkQiIpCnBhcnNlci5hZGRf
        YXJndW1lbnQoIi0tYWdjIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0i
        ZW5hYmxlIEFHQyIpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tbm9icm9rZXIi
        LCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSJkaXNhYmxlIG1xdHQgYnJv
        a2VyIikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1kdW1iIiwgYWN0aW9uPSJz
        dG9yZV90cnVlIiwgaGVscD0iZHVtYiB0ZXJtaW5hbCIpCnBhcnNlci5hZGRf
        YXJndW1lbnQoIi0tb3V0cHV0IiwgZGVmYXVsdD0ib3V0IiwgaGVscD0id3Jp
        dGUgQ0YzMiBzYW1wbGVzIHRvIGZpbGUiKQpwYXJzZXIuYWRkX2FyZ3VtZW50
        KCItLW5vd2F2ZSIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9ImRpc2Fi
        bGUgV0FWIGhlYWRlciIpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tbWV0ZXIi
        LCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxwPSJlbmFibGUgY29uc29sZSBw
        ZWFrIG1ldGVyIikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1wYXVzZSIsIGFj
        dGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9InBhdXNlIG91dHB1dCIpCnBhcnNl
        ci5hZGRfYXJndW1lbnQoIi0tcmVmcmVzaCIsIGRlZmF1bHQ9NSwgaGVscD0i
        cGVhayBtZXRlciByZWZyZXNoIGluIHNlY29uZHMiKQoKIyBhcmdTdHJpbmcK
        cGFyc2VyLmFkZF9hcmd1bWVudCgiLS1kaXJlY3Qtc2FtcCIsIGhlbHA9IjA9
        b2ZmLCAxPUksIDI9USBjaGFubmVsIikKcGFyc2VyLmFkZF9hcmd1bWVudCgi
        LS1pcS1zd2FwIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0ic3dhcCBJ
        USBzaWduYWxzIikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1iaWFzdGVlIiwg
        YWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZW5hYmxlIGJpYXMgdGVlIikK
        cGFyc2VyLmFkZF9hcmd1bWVudCgiLS1kaWdpdGFsLWFnYyIsIGFjdGlvbj0i
        c3RvcmVfdHJ1ZSIsIGhlbHA9ImVuYWJsZSBkaWdpdGFsIEFHQyIpCnBhcnNl
        ci5hZGRfYXJndW1lbnQoIi0tb2Zmc2V0LXR1bmUiLCBhY3Rpb249InN0b3Jl
        X3RydWUiLCBoZWxwPSJlbmFibGUgb2Zmc2V0IHR1bmUiKQoKCmRlZiBnZW5f
        dG9waWMobmFtZT1Ob25lKToKICAgIGQgPSBhcmdzLnRvcGljLnNwbGl0KCcv
        JylbOi0xXQogICAgaWYgbmFtZSBpcyBub3QgTm9uZToKICAgICAgICBkLmFw
        cGVuZChuYW1lKQogICAgcmV0dXJuICcvJy5qb2luKGQpCgoKZGVmIHRvX2Zs
        b2F0KHBhcmFtKToKICAgIHRyeToKICAgICAgICByZXR1cm4gZmxvYXQocGFy
        YW0pCiAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICBwYXNzCgojIyMK
        CmRlZiBvbl9mYXRhbChwYXJhbSk6CiAgICBnbG9iYWwgZmF0YWwKICAgIGlm
        IHBhcmFtLmxvd2VyKCkgPT0gInRydWUiOgogICAgICAgIGZhdGFsID0gVHJ1
        ZQogICAgICAgIGluZm8oJ2ZhdGFsIGtpbGxpbmcnKQogICAgZWxzZToKICAg
        ICAgICBpbmZvKCdiYWQgZmF0YWwgY29tbWFuZCcpCgoKZGVmIG9uX2tpbGwo
        cGFyYW0pOgogICAgZ2xvYmFsIGtpbGxlZAogICAgaWYgcGFyYW0ubG93ZXIo
        KSA9PSAidHJ1ZSI6CiAgICAgICAga2lsbGVkID0gVHJ1ZQogICAgICAgIGlu
        Zm8oJ2tpbGxpbmcgc3RyZWFtJykKICAgIGVsc2U6CiAgICAgICAgaW5mbygn
        YmFkIGtpbGwgY29tbWFuZCcpCgoKZGVmIG9uX3BhdXNlKHBhcmFtKToKICAg
        IGdsb2JhbCBwYXVzZWQKICAgIGlmIHBhcmFtOgogICAgICAgIHBhdXNlZCA9
        IHBhcmFtLmxvd2VyKCkgPT0gInRydWUiCiAgICBicm9rZXIucHVibGlzaChn
        ZW5fdG9waWMoInBhdXNlIiksICdvbicgaWYgcGF1c2VkIGVsc2UgJ29mZicp
        CgoKZGVmIG9uX3JhdGUocGFyYW0pOgogICAgZ2xvYmFsIHJhdGUKICAgIGlm
        IHBhcmFtOgogICAgICAgIHBhcmFtID0gdG9fZmxvYXQocGFyYW0pCiAgICAg
        ICAgaWYgcGFyYW0gaXMgTm9uZToKICAgICAgICAgICAgaW5mbygnYmFkIHNh
        bXBsZSByYXRlIGNvbW1hbmQnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAg
        IHJhZGlvLnNldFNhbXBsZVJhdGUoU09BUFlfU0RSX1JYLCAwLCBwYXJhbSkK
        ICAgIHJhdGUgPSByYWRpby5nZXRTYW1wbGVSYXRlKFNPQVBZX1NEUl9SWCwg
        MCkKICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3BpYygicmF0ZSIpLCBmJ3ty
        YXRlLzFlMzouM2Z9IEtIeicpCgoKZGVmIG9uX2ZyZXEocGFyYW0pOgogICAg
        aWYgcGFyYW06CiAgICAgICAgcGFyYW0gPSB0b19mbG9hdChwYXJhbSkKICAg
        ICAgICBpZiBwYXJhbSBpcyBOb25lOgogICAgICAgICAgICBpbmZvKCdiYWQg
        ZnJlcXVlbmN5IGNvbW1hbmQnKQogICAgICAgIGVsc2U6CiAgICAgICAgICAg
        IHJhZGlvLnNldEZyZXF1ZW5jeShTT0FQWV9TRFJfUlgsIDAsIHBhcmFtKQog
        ICAgZnJlcSA9IHJhZGlvLmdldEZyZXF1ZW5jeShTT0FQWV9TRFJfUlgsIDAp
        CiAgICBicm9rZXIucHVibGlzaChnZW5fdG9waWMoImZyZXEiKSwgZid7ZnJl
        cS8xZTY6LjZmfSBNSHonKQoKCmRlZiBvbl9nYWluKHBhcmFtKToKICAgIGlm
        IHBhcmFtOgogICAgICAgIHBhcmFtID0gdG9fZmxvYXQocGFyYW0pCiAgICAg
        ICAgaWYgcGFyYW0gaXMgTm9uZToKICAgICAgICAgICAgaW5mbygnYmFkIGdh
        aW4gY29tbWFuZCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFkaW8u
        c2V0R2FpbihTT0FQWV9TRFJfUlgsIDAsIHBhcmFtKQogICAgZ2FpbiA9IHJh
        ZGlvLmdldEdhaW4oU09BUFlfU0RSX1JYLCAwKQogICAgYnJva2VyLnB1Ymxp
        c2goZ2VuX3RvcGljKCJnYWluIiksIGYne2dhaW46LjNnfSBkQicpCgoKZGVm
        IG9uX2F1dG8ocGFyYW0pOgogICAgaWYgcGFyYW06CiAgICAgICAgcmFkaW8u
        c2V0R2Fpbk1vZGUoU09BUFlfU0RSX1JYLCAwLCBwYXJhbS5sb3dlcigpID09
        ICJ0cnVlIikKICAgIGFnYyA9IHJhZGlvLmdldEdhaW5Nb2RlKFNPQVBZX1NE
        Ul9SWCwgMCkKICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3BpYygiYWdjIiks
        ICdvbicgaWYgYWdjIGVsc2UgJ29mZicpCgoKZGVmIG9uX3NldHRpbmcoa2V5
        LCBwYXJhbSk6CiAgICBpZiBwYXJhbToKICAgICAgICByYWRpby53cml0ZVNl
        dHRpbmcoa2V5LCBwYXJhbSkKICAgIHZhbCA9IHJhZGlvLnJlYWRTZXR0aW5n
        KGtleSkKICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3BpYyhrZXkpLCBzdHIo
        dmFsKSkKCgpkZWYgb25fcHBzKHBheWxvYWQpOgogICAgaWYgdGltZWZpbGUg
        YW5kIG5vdCBwYXVzZWQ6CiAgICAgICAgc2VjID0gc2FtcGxlc190b3RhbCAv
        IHJhdGUKICAgICAgICB0aW1lZmlsZS53cml0ZShmIntzZWM6LjNmfVx0e3Nl
        YzouM2Z9XHR7cGF5bG9hZH1cbiIpCiAgICAgICAgdGltZWZpbGUuZmx1c2go
        KQoKCmRlZiBvbl9tZXNzYWdlKGNsaWVudCwgdXNlcmRhdGEsIG1zZyk6CiAg
        ICBwYXlsb2FkID0gbXNnLnBheWxvYWQuZGVjb2RlKCdsYXRpbicpLnN0cmlw
        KCkKICAgIHRyeToKICAgICAgICBpZiBwYXlsb2FkIGFuZCBtc2cudG9waWMg
        PT0gYXJncy5wcHNfdG9waWM6CiAgICAgICAgICAgIG9uX3BwcyhwYXlsb2Fk
        KQogICAgICAgIGlmIHBheWxvYWQgYW5kIG1zZy50b3BpYyA9PSBhcmdzLnRv
        cGljOgogICAgICAgICAgICBjbWQsIF8sIHBhcmFtID0gcGF5bG9hZC5wYXJ0
        aXRpb24oJyAnKSAKICAgICAgICAgICAgcGFyYW0gPSBwYXJhbS5zdHJpcCgp
        CiAgICAgICAgICAgIGlmIGNtZCA9PSAncCc6CiAgICAgICAgICAgICAgICBv
        bl9wYXVzZShwYXJhbSkKICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ2cnOgog
        ICAgICAgICAgICAgICAgb25fZ2FpbihwYXJhbSkKICAgICAgICAgICAgZWxp
        ZiBjbWQgPT0gJ2EnOgogICAgICAgICAgICAgICAgb25fYXV0byhwYXJhbSkK
        ICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ3InOgogICAgICAgICAgICAgICAg
        b25fcmF0ZShwYXJhbSkKICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ2YnOgog
        ICAgICAgICAgICAgICAgb25fZnJlcShwYXJhbSkKICAgICAgICAgICAgZWxp
        ZiBjbWQgPT0gJ2snOgogICAgICAgICAgICAgICAgb25fa2lsbChwYXJhbSkK
        ICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ0snOgogICAgICAgICAgICAgICAg
        b25fZmF0YWwocGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdkcyc6
        CiAgICAgICAgICAgICAgICBvbl9zZXR0aW5nKCJkaXJlY3Rfc2FtcCIsIHBh
        cmFtKQogICAgICAgICAgICBlbGlmIGNtZCA9PSAnaXEnOgogICAgICAgICAg
        ICAgICAgb25fc2V0dGluZygiaXFfc3dhcCIsIHBhcmFtKQogICAgICAgICAg
        ICBlbGlmIGNtZCA9PSAnYnQnOgogICAgICAgICAgICAgICAgb25fc2V0dGlu
        ZygiYmlhc3RlZSIsIHBhcmFtKQogICAgICAgICAgICBlbGlmIGNtZCA9PSAn
        ZGEnOgogICAgICAgICAgICAgICAgb25fc2V0dGluZygiZGlnaXRhbF9hZ2Mi
        LCBwYXJhbSkKICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ290JzoKICAgICAg
        ICAgICAgICAgIG9uX3NldHRpbmcoIm9mZnNldF90dW5lIiwgcGFyYW0pCiAg
        ICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBpbmZvKCd1bmtub3du
        IGNvbW1hbmQnKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
        IGluZm8oZiJFeGNlcHRpb24gb25fbWVzc2FnZSgpOiB7ZX0iKQoKCmRlZiBv
        bl9jb25uZWN0KGNsaWVudCwgdXNlcmRhdGEsIGZsYWdzLCByYyk6CiAgICBj
        bGllbnQuc3Vic2NyaWJlKGdlbl90b3BpYygnIycpKQogICAgY2xpZW50LnN1
        YnNjcmliZShhcmdzLnBwc190b3BpYykKCgojIyMjIyMjIyMjIyMjIyMzCgoK
        ZGVmIGluZm8ocGF5bG9hZCk6CiAgICBwcmludChwYXlsb2FkLCBmaWxlPXN5
        cy5zdGRlcnIpCiAgICBpZiBicm9rZXI6CiAgICAgICAgYnJva2VyLnB1Ymxp
        c2goZ2VuX3RvcGljKCJpbmZvIiksIHBheWxvYWQpCgoKZGVmIGxvZ19oYW5k
        bGVyKGxvZ19sZXZlbCwgbG9nX21lc3NhZ2UpOgogICAgaWYgYnJva2VyOgog
        ICAgICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3BpYygibG9nIiksIGxvZ19t
        ZXNzYWdlKQoKCmRlZiB3YXZfaGVhZGVyKHJhdGUsIGNoYW5uZWxzPTIsIHNh
        bXBsZV9ieXRlcz00KToKICAgIHJhdGUgPSBpbnQocmF0ZSkKICAgIGRhdGFf
        aWQgPSBiJ2RhdGEnCiAgICBkYXRhX3NpemUgPSAweDgwMDAwMDAwCiAgICBy
        aWZmX2lkID0gYidSSUZGJwogICAgcmlmZl9mb3JtYXQgPSBiJ1dBVkUnCiAg
        ICBmbXRfaWQgPSBiJ2ZtdCAnCiAgICBmbXRfc2l6ZSA9IDE2CiAgICBmbXRf
        Zm9ybWF0ID0gMyAgICAjIElFRUVfRkxPQVQKICAgIGJ1ZiA9IHN0cnVjdC5w
        YWNrKCc8NHNJNHMnLCByaWZmX2lkLCBkYXRhX3NpemUgKyAyMCArIGZtdF9z
        aXplLCByaWZmX2Zvcm1hdCkKICAgIGJ1ZiArPSBzdHJ1Y3QucGFjaygnPDRz
        SUhIJywgZm10X2lkLCBmbXRfc2l6ZSwgZm10X2Zvcm1hdCwgY2hhbm5lbHMp
        CiAgICBidWYgKz0gc3RydWN0LnBhY2soJzxJSUhIJywKICAgICAgICByYXRl
        LCAgICAgICAgICAgICAgICAgICAgICAgICAgICMgMzItYml0CiAgICAgICAg
        cmF0ZSAqIGNoYW5uZWxzICogc2FtcGxlX2J5dGVzLCAjIDMyLWJpdAogICAg
        ICAgIGNoYW5uZWxzICogc2FtcGxlX2J5dGVzLAogICAgICAgIHNhbXBsZV9i
        eXRlcyAqIDgpCiAgICBidWYgKz0gc3RydWN0LnBhY2soJzw0c0knLCBkYXRh
        X2lkLCBkYXRhX3NpemUpCiAgICByZXR1cm4gYnVmCgoKZGVmIHJhZGlvX2Nv
        bm5lY3QoKToKICAgIGdsb2JhbCByYWRpbwogICAgZHJpdmVycyA9IFsgZFsn
        ZHJpdmVyJ10gZm9yIGQgaW4gU29hcHlTRFIuRGV2aWNlLmVudW1lcmF0ZSgp
        IF0KICAgIGluZm8oZiJGb3VuZCBkcml2ZXJzOiB7ZHJpdmVyc30iKQogICAg
        a3cgPSB7fQogICAgaWYgYXJncy5kcml2ZXI6CiAgICAgICAga3dbJ2RyaXZl
        ciddID0gYXJncy5kcml2ZXIKICAgIGluZm8oZiJQYXNzaW5nIHRoZSBmb2xs
        b3dpbmcgYXJndW1lbnRzOiB7a3d9IikKICAgIHJhZGlvID0gU29hcHlTRFIu
        RGV2aWNlKGt3KQoKCmRlZiByYWRpb19zZXR0aW5ncygpOgogICAgaW5mbyhm
        IkluaXRpYWxpemluZyByYWRpbyBzZXR0aW5ncyIpCiAgICBpZiBhcmdzLmZy
        ZXE6CiAgICAgICAgcmFkaW8uc2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9SWCwg
        MCwgYXJncy5mcmVxKQogICAgaWYgYXJncy5yYXRlOgogICAgICAgIHJhZGlv
        LnNldFNhbXBsZVJhdGUoU09BUFlfU0RSX1JYLCAwLCBhcmdzLnJhdGUpCiAg
        ICByYWRpby5zZXRHYWluTW9kZShTT0FQWV9TRFJfUlgsIDAsIGFyZ3MuYWdj
        KTsKICAgIGlmIGFyZ3MuZ2FpbjoKICAgICAgICByYWRpby5zZXRHYWluKFNP
        QVBZX1NEUl9SWCwgMCwgYXJncy5nYWluKQogICAgaWYgYXJncy5kaXJlY3Rf
        c2FtcDoKICAgICAgICByYWRpby53cml0ZVNldHRpbmcoImRpcmVjdF9zYW1w
        IiwgYXJncy5kaXJlY3Rfc2FtcCkKICAgIGlmIGFyZ3MuaXFfc3dhcDoKICAg
        ICAgICByYWRpby53cml0ZVNldHRpbmcoImlxX3N3YXAiLCAidHJ1ZSIpCiAg
        ICBpZiBhcmdzLmJpYXN0ZWU6CiAgICAgICAgcmFkaW8ud3JpdGVTZXR0aW5n
        KCJiaWFzdGVlIiwgInRydWUiKQogICAgaWYgYXJncy5kaWdpdGFsX2FnYzoK
        ICAgICAgICByYWRpby53cml0ZVNldHRpbmcoImRpZ2l0YWxfYWdjIiwgInRy
        dWUiKQogICAgaWYgYXJncy5kaWdpdGFsX2FnYzoKICAgICAgICByYWRpby53
        cml0ZVNldHRpbmcoIm9mZnNldF90dW5lIiwgInRydWUiKQoKCmRlZiBtYWlu
        X2luaXQoKToKICAgIGdsb2JhbCBwYXVzZWQsIGtpbGxlZCwgZmF0YWwKICAg
        IGtpbGxlZCA9IEZhbHNlCiAgICBmYXRhbCA9IEZhbHNlCiAgICBwYXVzZWQg
        PSBhcmdzLnBhdXNlCgoKZGVmIGJyb2tlcl9pbml0KCk6CiAgICBnbG9iYWwg
        YnJva2VyLCB0aW1lZmlsZQogICAgdGltZWZpbGUgPSBOb25lCiAgICBicm9r
        ZXIgPSBOb25lCiAgICBpZiBub3QgYXJncy5ub2Jyb2tlcjoKICAgICAgICBp
        bmZvKGYiQ29ubmVjdGluZyB0byBicm9rZXI6IHthcmdzLmJyb2tlcn0iKQog
        ICAgICAgIGJyb2tlciA9IG1xdHQuQ2xpZW50KCkKICAgICAgICBicm9rZXIu
        b25fY29ubmVjdCA9IG9uX2Nvbm5lY3QKICAgICAgICBicm9rZXIub25fbWVz
        c2FnZSA9IG9uX21lc3NhZ2UKICAgICAgICBicm9rZXIuY29ubmVjdChhcmdz
        LmJyb2tlciwgYXJncy5wb3J0LCBhcmdzLmtlZXBhbGl2ZSkKICAgICAgICBi
        cm9rZXIubG9vcF9zdGFydCgpCgoKZGVmIG1haW4oKToKICAgIGJyb2tlcl9p
        bml0KCkKICAgIFNvYXB5U0RSLnJlZ2lzdGVyTG9nSGFuZGxlcihsb2dfaGFu
        ZGxlcikKICAgIGluaXRpYWxpemVkPSBGYWxzZQogICAgd2hpbGUgVHJ1ZToK
        ICAgICAgICB0cnk6CiAgICAgICAgICAgIG1haW5faW5pdCgpCiAgICAgICAg
        ICAgIHJhZGlvX2Nvbm5lY3QoKQogICAgICAgICAgICBpZiBub3QgaW5pdGlh
        bGl6ZWQ6CiAgICAgICAgICAgICAgICByYWRpb19zZXR0aW5ncygpCiAgICAg
        ICAgICAgIGluaXRpYWxpemVkID0gVHJ1ZQogICAgICAgICAgICByYWRpb19z
        dGFydCgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
        ICAgICBpbmZvKGYiRXhjZXB0aW9uIG1haW4oKToge2V9IikKICAgICAgICAg
        ICAgdGltZS5zbGVlcChyZXN0YXJ0X3NlY29uZHMpCgoKZGVmIGNsb3NlX2Zp
        bGUoZiwgbmFtZSk6CiAgICBpZiBmOgogICAgICAgIGluZm8oZiJDbG9zaW5n
        IHtuYW1lfSBmaWxlLiIpCiAgICAgICAgZi5jbG9zZSgpCgoKZGVmIG9wZW5f
        ZmlsZXMoKToKICAgIGR0ID0gZGF0ZXRpbWUudXRjbm93KCkKICAgIHRzID0g
        ZHQuc3RyZnRpbWUoJyV5JW0lZF8lSCVNJVMnKQogICAgZnJlcSA9IHJhZGlv
        LmdldEZyZXF1ZW5jeShTT0FQWV9TRFJfUlgsIDApCiAgICBiYXNlbmFtZSA9
        IGYie2FyZ3Mub3V0cHV0fV97dHN9Wl97ZnJlcS8xZTY6LjZmfU1IeiIKICAg
        IGV4dCA9ICd0eHQnCiAgICBmaWxlbmFtZSA9IGYie2Jhc2VuYW1lfS57ZXh0
        fSIKICAgIGluZm8oZiJPcGVuaW5nIHtmaWxlbmFtZX0gZm9yIGdwcyB0aW1l
        IikKICAgIHRpbWVmaWxlID0gb3BlbihmaWxlbmFtZSwgInciKQogICAgZXh0
        ID0gJ3JhdycgaWYgYXJncy5ub3dhdmUgZWxzZSAnd2F2JwogICAgZmlsZW5h
        bWUgPSBmIntiYXNlbmFtZX0ue2V4dH0iCiAgICBpbmZvKGYiT3BlbmluZyB7
        ZmlsZW5hbWV9IGZvciBhdWRpbyIpCiAgICBhdWRpb2ZpbGUgPSBvcGVuKGZp
        bGVuYW1lLCAid2IiKQogICAgaWYgbm90IGFyZ3Mubm93YXZlOgogICAgICAg
        IGF1ZGlvZmlsZS53cml0ZSh3YXZfaGVhZGVyKHJhdGU9cmF0ZSkpCiAgICBy
        ZXR1cm4gYXVkaW9maWxlLCB0aW1lZmlsZQoKCmRlZiBjbG9zZV9zdHJlYW0o
        c3RyZWFtKToKICAgIGluZm8oZiJDbG9zaW5nIHJhZGlvIHN0cmVhbS4iKQog
        ICAgcmFkaW8uZGVhY3RpdmF0ZVN0cmVhbShzdHJlYW0pIAogICAgcmFkaW8u
        Y2xvc2VTdHJlYW0oc3RyZWFtKQoKCmRlZiByYWRpb19wZWFrKHBlYWtfbGV2
        ZWwpOgogICAgZGIgPSAiezouMWZ9IGRCIi5mb3JtYXQoMjAgKiBucC5sb2cx
        MChwZWFrX2xldmVsICsgMWUtOTkpKQogICAgaWYgYXJncy5tZXRlcjoKICAg
        ICAgICBidWYgPSBmIntkYn1cbiIgaWYgYXJncy5kdW1iIGVsc2UgZiJcMzNb
        Mkt7ZGI6PjlzfVxyIgogICAgICAgIHByaW50KGJ1ZiwgZW5kPSIiLCBmaWxl
        PXN5cy5zdGRlcnIpCiAgICBpZiBicm9rZXI6CiAgICAgICAgYnJva2VyLnB1
        Ymxpc2goZ2VuX3RvcGljKCJwZWFrIiksIGRiKQoKCmRlZiByYWRpb19zdGFy
        dCgpOgogICAgZ2xvYmFsIHJhdGUsIHRpbWVmaWxlLCBzYW1wbGVzX3RvdGFs
        CiAgICByYXRlID0gcmFkaW8uZ2V0U2FtcGxlUmF0ZShTT0FQWV9TRFJfUlgs
        IDApCiAgICBzaXplID0gYXJncy5wYWNrZXRfc2l6ZQogICAgZGF0YSA9IG5w
        LmFycmF5KFswXSAqIHNpemUgKiAyLCBucC5mbG9hdDMyKQogICAgc3RyZWFt
        ID0gcmFkaW8uc2V0dXBTdHJlYW0oU09BUFlfU0RSX1JYLCBTT0FQWV9TRFJf
        Q0YzMikKICAgIHJhZGlvLmFjdGl2YXRlU3RyZWFtKHN0cmVhbSkgCiAgICBz
        YW1wbGVzX3RvdGFsID0gMAogICAgcGVha19sZXZlbCA9IDAKICAgIHNhbXBs
        ZV9udW0gPSAwCiAgICBvdXRmaWxlID0gTm9uZQogICAgdHJ5OgogICAgICAg
        IHdoaWxlIG5vdCBraWxsZWQgYW5kIG5vdCBmYXRhbDoKICAgICAgICAgICAg
        cmFkaW8ucmVhZFN0cmVhbShzdHJlYW0sIFtkYXRhXSwgc2l6ZSkKICAgICAg
        ICAgICAgaWYgbm90IHBhdXNlZDoKICAgICAgICAgICAgICAgIGlmIG5vdCBv
        dXRmaWxlOgogICAgICAgICAgICAgICAgICAgIG91dGZpbGUsIHRpbWVmaWxl
        ID0gb3Blbl9maWxlcygpCiAgICAgICAgICAgICAgICBzYW1wbGVzX3RvdGFs
        ICs9IHNpemUKICAgICAgICAgICAgICAgIG91dGZpbGUud3JpdGUoZGF0YSkK
        ICAgICAgICAgICAgcGVha19sZXZlbCA9IG1heChwZWFrX2xldmVsLCBhYnMo
        ZGF0YS5taW4oKSksIGFicyhkYXRhLm1heCgpKSkKICAgICAgICAgICAgc2Ft
        cGxlX251bSArPSBzaXplCiAgICAgICAgICAgIGlmIHNhbXBsZV9udW0gPiBy
        YXRlICogYXJncy5yZWZyZXNoOgogICAgICAgICAgICAgICAgcmFkaW9fcGVh
        ayhwZWFrX2xldmVsKQogICAgICAgICAgICAgICAgcGVha19sZXZlbCA9IDAK
        ICAgICAgICAgICAgICAgIHNhbXBsZV9udW0gPSAwCiAgICBleGNlcHQgKEtl
        eWJvYXJkSW50ZXJydXB0LCBTeXN0ZW1FcnJvcikgYXMgZToKICAgICAgICBp
        bmZvKGYiRXhjZXB0aW9uIHJhZGlvX3N0YXJ0KCk6IHtlfSIpCiAgICBjbG9z
        ZV9maWxlKG91dGZpbGUsICJhdWRpbyIpCiAgICB0aW1lZmlsZSA9IGNsb3Nl
        X2ZpbGUodGltZWZpbGUsICJ0aW1lIikKICAgIGNsb3NlX3N0cmVhbShzdHJl
        YW0pCiAgICBpZiBmYXRhbDoKICAgICAgICBpbmZvKCJGYXRhbCBjb21tYW5k
        IGdpdmVuLCBraWxsaW5nIHByb2Nlc3MiKQogICAgICAgIHN5cy5leGl0KDEp
        CgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGFyZ3MgPSBwYXJz
        ZXIucGFyc2VfYXJncygpCiAgICBtYWluKCkKCg==


  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqpps
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgYXJncGFyc2UKaW1wb3J0IHBh
        aG8ubXF0dC5jbGllbnQgYXMgbXF0dApmcm9tIGRhdGV0aW1lIGltcG9ydCBk
        YXRldGltZQpmcm9tIGdwcyBpbXBvcnQgZ3BzLCBXQVRDSF9FTkFCTEUsIFdB
        VENIX05FV1NUWUxFCgpwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNl
        cigKICAgIGZvcm1hdHRlcl9jbGFzcz1hcmdwYXJzZS5Bcmd1bWVudERlZmF1
        bHRzSGVscEZvcm1hdHRlcikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1icm9r
        ZXIiLCBkZWZhdWx0PSIxMjcuMC4wLjEiLCBoZWxwPSdicm9rZXIgaG9zdCcp
        CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcG9ydCIsIGRlZmF1bHQ9MTg4Mywg
        aGVscD0nYnJva2VyIHBvcnQnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWtl
        ZXBhbGl2ZSIsIGRlZmF1bHQ9NjAsIGhlbHA9J2Jyb2tlciBrZWVwIGFsaXZl
        JykKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1wcHMtdG9waWMiLCBkZWZhdWx0
        PSJwcHMiLCBoZWxwPSdQUFMgdG9waWMnKQpwYXJzZXIuYWRkX2FyZ3VtZW50
        KCItLWludGVydmFsIiwgZGVmYXVsdD0xMCwgaGVscD0ncHVibGlzaCBpbnRl
        cnZhbCBpbiBzZWNvbmRzJykKCmRlZiBnZW5fdG9waWMobmFtZT1Ob25lKToK
        ICAgIGQgPSBhcmdzLnRvcGljLnNwbGl0KCcvJylbOi0xXQogICAgaWYgbmFt
        ZSBpcyBub3QgTm9uZToKICAgICAgICBkLmFwcGVuZChuYW1lKQogICAgcmV0
        dXJuICcvJy5qb2luKGQpCgpkZWYgb25fY29ubmVjdChjbGllbnQsIHVzZXJk
        YXRhLCBmbGFncywgcmMpOgogICAgY2xpZW50LnN1YnNjcmliZShnZW5fdG9w
        aWMoJyMnKSkKCmRlZiBvbl9tZXNzYWdlKGNsaWVudCwgdXNlcmRhdGEsIG1z
        Zyk6CiAgICBwYXlsb2FkID0gbXNnLnBheWxvYWQuZGVjb2RlKCdsYXRpbicp
        LnN0cmlwKCkKICAgIGlmIG1zZy50b3BpYyA9PSBhcmdzLnBwc190b3BpYzoK
        ICAgICAgICBwcmludChmJ3ttc2cudG9waWN9IHtwYXlsb2FkfScpCgpkZWYg
        bWFpbigpOgogICAgY2xpZW50ID0gbXF0dC5DbGllbnQoKQogICAgY2xpZW50
        Lm9uX2Nvbm5lY3QgPSBvbl9jb25uZWN0CiAgICBjbGllbnQub25fbWVzc2Fn
        ZSA9IG9uX21lc3NhZ2UKICAgIGNsaWVudC5jb25uZWN0KGFyZ3MuYnJva2Vy
        LCBhcmdzLnBvcnQsIGFyZ3Mua2VlcGFsaXZlKQogICAgY2xpZW50Lmxvb3Bf
        c3RhcnQoKQogICAgbW9kZSA9IFdBVENIX0VOQUJMRSB8IFdBVENIX05FV1NU
        WUxFCiAgICBzZXNzaW9uID0gZ3BzKG1vZGU9bW9kZSkKICAgIGZvciBueCBp
        biBzZXNzaW9uOgogICAgICAgIGlmIG54WydjbGFzcyddID09ICdUUFYnOgog
        ICAgICAgICAgICBtb2RlID0gbnhbJ21vZGUnXQogICAgICAgICAgICB0cyA9
        IG54LmdldCgndGltZScpCiAgICAgICAgICAgIGlmIHRzIGFuZCAobW9kZSA9
        PSAyIG9yIG1vZGUgPT0gMyk6CiAgICAgICAgICAgICAgICBkdCA9IGRhdGV0
        aW1lLnN0cnB0aW1lKHRzLCAiJVktJW0tJWRUJUg6JU06JVMuJWZaIikKICAg
        ICAgICAgICAgICAgIGlmIGR0LnNlY29uZCAlIGFyZ3MuaW50ZXJ2YWwgPT0g
        MDoKICAgICAgICAgICAgICAgICAgICBjbGllbnQucHVibGlzaChhcmdzLnBw
        c190b3BpYywgdHMpIAoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAg
        IGFyZ3MgPSBwYXJzZXIucGFyc2VfYXJncygpCiAgICBtYWluKCkKCgo=


  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqclient
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgc3lzCmltcG9ydCBhcmdwYXJz
        ZQppbXBvcnQgcGFoby5tcXR0LmNsaWVudCBhcyBtcXR0CgpwYXJzZXIgPSBh
        cmdwYXJzZS5Bcmd1bWVudFBhcnNlcigKICAgIGZvcm1hdHRlcl9jbGFzcz1h
        cmdwYXJzZS5Bcmd1bWVudERlZmF1bHRzSGVscEZvcm1hdHRlcikKcGFyc2Vy
        LmFkZF9hcmd1bWVudCgiLS1icm9rZXIiLCBkZWZhdWx0PSIxMjcuMC4wLjEi
        LCBoZWxwPSdicm9rZXIgaG9zdCcpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0t
        cG9ydCIsIGRlZmF1bHQ9MTg4MywgaGVscD0nYnJva2VyIHBvcnQnKQpwYXJz
        ZXIuYWRkX2FyZ3VtZW50KCItLWtlZXBhbGl2ZSIsIGRlZmF1bHQ9NjAsIGhl
        bHA9J2Jyb2tlciBrZWVwIGFsaXZlJykKcGFyc2VyLmFkZF9hcmd1bWVudCgi
        LS10b3BpYyIsIGRlZmF1bHQ9ImYvdHgiLCBoZWxwPSdjb21tYW5kIHRvcGlj
        JykKCmRlZiBvbl9jb25uZWN0KGNsaWVudCwgdXNlcmRhdGEsIGZsYWdzLCBy
        Yyk6CiAgICBjbGllbnQuc3Vic2NyaWJlKCIjIikKCmRlZiBvbl9tZXNzYWdl
        KGNsaWVudCwgdXNlcmRhdGEsIG1zZyk6CiAgICBwcmludChtc2cudG9waWMg
        KyAiICIgKyBtc2cucGF5bG9hZC5kZWNvZGUoJ2xhdGluJykpCgpkZWYgbWFp
        bigpOgogICAgY2xpZW50ID0gbXF0dC5DbGllbnQoKQogICAgY2xpZW50Lm9u
        X2Nvbm5lY3QgPSBvbl9jb25uZWN0CiAgICBjbGllbnQub25fbWVzc2FnZSA9
        IG9uX21lc3NhZ2UKICAgIGNsaWVudC5jb25uZWN0KGFyZ3MuYnJva2VyLCBh
        cmdzLnBvcnQsIGFyZ3Mua2VlcGFsaXZlKQogICAgY2xpZW50Lmxvb3Bfc3Rh
        cnQoKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBsaW5lID0gbmV4dChzeXMu
        c3RkaW4pLnJzdHJpcCgpCiAgICAgICAgY2xpZW50LnB1Ymxpc2goYXJncy50
        b3BpYywgbGluZSkgCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAg
        YXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKICAgIG1haW4oKQoKCg==



  - become: yes
    copy:
      dest: /lib/systemd/system/mqproxy.service
      content: |
        [Service]
        ExecStart=/usr/bin/python3 -u /usr/local/bin/mqproxy
        Restart=on-failure
        RestartSec=10s
        [Install]
        WantedBy=multi-user.target

  - become: yes
    copy:
      dest: /lib/systemd/system/mqsoapy.service
      content: |
        [Service]
        ExecStart=/usr/bin/python3 -u /usr/local/bin/mqsoapy --pause --output {{ fs_path }}/out
        # WorkingDirectory={{ fs_path }}
        User=george
        Restart=on-failure
        RestartSec=10s
        [Install]
        WantedBy=multi-user.target

  - become: yes
    copy:
      dest: /lib/systemd/system/mqpps.service
      content: |
        [Service]
        ExecStart=/usr/bin/python3 -u /usr/local/bin/mqpps
        Restart=on-failure
        RestartSec=10s
        [Install]
        WantedBy=multi-user.target

  - become: yes
    shell: |
      sudo systemctl enable mqproxy
      sudo systemctl enable mqsoapy
      sudo systemctl enable mqpps

  - become: yes
    shell: |
      sudo systemctl restart mqproxy
      sudo systemctl restart mqsoapy
      sudo systemctl restart mqpps

