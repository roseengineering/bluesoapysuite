---
  - set_fact:
      fs_path: "{{ fs_path | default('/srv') }}"

  # pip

  - become: yes
    pip:
      name:
      - paho-mqtt

  # code

  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqsoapy
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgb3MsIHN5cywgdGltZQppbXBv
        cnQgc29ja2V0LCBzZWxlY3QKaW1wb3J0IHN0cnVjdAppbXBvcnQgYXJncGFy
        c2UKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYWhvLm1xdHQuY2xpZW50
        IGFzIG1xdHQKaW1wb3J0IFNvYXB5U0RSCmZyb20gZGF0ZXRpbWUgaW1wb3J0
        IGRhdGV0aW1lCmZyb20gU29hcHlTRFIgaW1wb3J0IFNPQVBZX1NEUl9SWCwg
        U09BUFlfU0RSX0NGMzIKCmNvbW1hbmRfZm10ID0gIj5CSSIKY29tbWFuZF9z
        aXplID0gc3RydWN0LmNhbGNzaXplKGNvbW1hbmRfZm10KQoKCnBhcnNlciA9
        IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKAogICAgZm9ybWF0dGVyX2NsYXNz
        PWFyZ3BhcnNlLkFyZ3VtZW50RGVmYXVsdHNIZWxwRm9ybWF0dGVyKQoKIyBi
        cm9rZXIKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1icm9rZXIiLCBkZWZhdWx0
        PSIwLjAuMC4wIiwgaGVscD0nYnJva2VyIGhvc3QnKQpwYXJzZXIuYWRkX2Fy
        Z3VtZW50KCItLWJyb2tlci1wb3J0IiwgZGVmYXVsdD0xODgzLCB0eXBlPWlu
        dCwgaGVscD0nYnJva2VyIHBvcnQnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCIt
        LWJyb2tlci1rZWVwYWxpdmUiLCBkZWZhdWx0PTYwLCB0eXBlPWludCwgaGVs
        cD0nYnJva2VyIGtlZXBhbGl2ZSBzZWNvbmRzJykKcGFyc2VyLmFkZF9hcmd1
        bWVudCgiLS10b3BpYyIsIGRlZmF1bHQ9ImYvdHgiLCBoZWxwPSdtcXR0IHRv
        cGljIGZvciBjb21tYW5kJykKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1wcHMt
        dG9waWMiLCBkZWZhdWx0PSJwcHMiLCBoZWxwPSdtcXR0IHRvcGljIGZvciBn
        cHMgcHBzIHRpbWUnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW5vYnJva2Vy
        IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZGlzYWJsZSBtcXR0IGJy
        b2tlciIpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcmVmcmVzaC1wcHMiLCBk
        ZWZhdWx0PTEwLCB0eXBlPWludCwgaGVscD0ncHBzIHJlZnJlc2ggaW4gc2Vj
        b25kcycpCgojIHNvYXB5CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tZHJpdmVy
        IiwgaGVscD0nbmFtZSBvZiBkcml2ZXInKQpwYXJzZXIuYWRkX2FyZ3VtZW50
        KCItLXBhY2tldC1zaXplIiwgZGVmYXVsdD0xMDI0LCB0eXBlPWludCwgaGVs
        cD0ncGFja2V0IHNpemUnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWZyZXEi
        LCB0eXBlPW5wLmZsb2F0LCBoZWxwPSJjZW50ZXIgZnJlcXVlbmN5IGluIGhl
        cnR6IikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1yYXRlIiwgdHlwZT1ucC5m
        bG9hdCwgaGVscD0ic2FtcGxlIHJhdGUgaW4gaGVydHoiKQpwYXJzZXIuYWRk
        X2FyZ3VtZW50KCItLWdhaW4iLCB0eXBlPW5wLmZsb2F0LCBoZWxwPSJmcm9u
        dCBlbmQgZ2FpbiBpbiBkQiIpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tYWdj
        IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZW5hYmxlIEFHQyIpCgoj
        IHNvYXB5IGFyZ1N0cmluZwpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWRpcmVj
        dC1zYW1wIiwgaGVscD0iMSBvciBpPUksIDIgb3IgcT1RIGNoYW5uZWwiKQpw
        YXJzZXIuYWRkX2FyZ3VtZW50KCItLWlxLXN3YXAiLCBhY3Rpb249InN0b3Jl
        X3RydWUiLCBoZWxwPSJzd2FwIElRIHNpZ25hbHMiKQpwYXJzZXIuYWRkX2Fy
        Z3VtZW50KCItLWJpYXN0ZWUiLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxw
        PSJlbmFibGUgYmlhcyB0ZWUiKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWRp
        Z2l0YWwtYWdjIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZW5hYmxl
        IGRpZ2l0YWwgQUdDIikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1vZmZzZXQt
        dHVuZSIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9ImVuYWJsZSBvZmZz
        ZXQgdHVuZSIpCgojIG90aGVyCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tb3V0
        cHV0IiwgZGVmYXVsdD0ib3V0IiwgaGVscD0id3JpdGUgQ0YzMiBzYW1wbGVz
        IHRvIGZpbGUiKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW5vd2F2ZSIsIGFj
        dGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9ImRpc2FibGUgV0FWIGhlYWRlciIp
        CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcGF1c2UiLCBhY3Rpb249InN0b3Jl
        X3RydWUiLCBoZWxwPSJwYXVzZSBvdXRwdXQiKQpwYXJzZXIuYWRkX2FyZ3Vt
        ZW50KCItLXJlc3RhcnQtc2Vjb25kcyIsIGRlZmF1bHQ9MTAsIGhlbHA9InJl
        c3RhcnQgZGVsYXkgaW4gc2Vjb25kcyIpCgojIHBlYWsgbWV0ZXIKcGFyc2Vy
        LmFkZF9hcmd1bWVudCgiLS1yZWZyZXNoIiwgZGVmYXVsdD01LCB0eXBlPWlu
        dCwgaGVscD0icGVhayBtZXRlciByZWZyZXNoIGluIHNlY29uZHMiKQpwYXJz
        ZXIuYWRkX2FyZ3VtZW50KCItLW1ldGVyIiwgYWN0aW9uPSJzdG9yZV90cnVl
        IiwgaGVscD0iZW5hYmxlIGNvbnNvbGUgcGVhayBtZXRlciIpCnBhcnNlci5h
        ZGRfYXJndW1lbnQoIi0tZHVtYiIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhl
        bHA9ImVuYWJsZSBkdW1iIHRlcm1pbmFsIGNvbnNvbGUiKQogCiMgdGNwIHNl
        cnZlcgpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWhvc3QiLCBkZWZhdWx0PSIw
        LjAuMC4wIiwgaGVscD0iQ0YzMiB0Y3Agc2VydmVyIGhvc3QgYWRkcmVzcyIp
        CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcG9ydCIsIHR5cGU9aW50LCBkZWZh
        dWx0PTEyMzQsIGhlbHA9IkNGMzIgdGNwIHNlcnZlciBwb3J0IGFkZHJlc3Mi
        KQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXJ0bHRjcCIsIGFjdGlvbj0ic3Rv
        cmVfdHJ1ZSIsIGhlbHA9ImVuYWJsZSBDVTggcnRsdGNwIHNlcnZlciBtb2Rl
        IikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1ub3NlcnZlciIsIGFjdGlvbj0i
        c3RvcmVfdHJ1ZSIsIGhlbHA9ImRpc2FibGUgdGNwIHNlcnZlciIpCnBhcnNl
        ci5hZGRfYXJndW1lbnQoIi0tZnJlZXplIiwgYWN0aW9uPSJzdG9yZV90cnVl
        IiwgaGVscD0iZnJlZXplIHRjcCBzZXJ2ZXIgc2V0dGluZ3MiKQpwYXJzZXIu
        YWRkX2FyZ3VtZW50KCItLXdyYXAiLCBhY3Rpb249InN0b3JlX3RydWUiLCBo
        ZWxwPSJ3cmFwIDAgSHogdG8gMTAwIE1IeiIpCgoKZGVmIGdlbl90b3BpYyhu
        YW1lPU5vbmUpOgogICAgZCA9IGFyZ3MudG9waWMuc3BsaXQoJy8nKVs6LTFd
        CiAgICBpZiBuYW1lIGlzIG5vdCBOb25lOgogICAgICAgIGQuYXBwZW5kKG5h
        bWUpCiAgICByZXR1cm4gJy8nLmpvaW4oZCkKCgpkZWYgdG9fZmxvYXQocGFy
        YW0pOgogICAgdHJ5OgogICAgICAgIHJldHVybiBmbG9hdChwYXJhbSkKICAg
        IGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHBhc3MKCgojIyMjIyMjIyMj
        IyMKCmRlZiBvbl9pbmZvKHBhcmFtKToKICAgIGNoYW4gPSAwCiAgICBmb3Ig
        ciBpbiByYWRpby5nZXRTYW1wbGVSYXRlUmFuZ2UoU09BUFlfU0RSX1JYLCBj
        aGFuKToKICAgICAgIHBheWxvYWQgPSAncmF0ZTogezouM2Z9IEtIeicuZm9y
        bWF0KHIubWluaW11bSgpIC8gMWUzKQogICAgICAgaW5mbyhwYXlsb2FkKQog
        ICAgZm9yIHIgaW4gcmFkaW8uZ2V0RnJlcXVlbmN5UmFuZ2UoU09BUFlfU0RS
        X1JYLCBjaGFuKToKICAgICAgIHBheWxvYWQgPSAnZnJlcTogezouNmZ9IC0g
        ezouNmZ9IE1IeicuZm9ybWF0KAogICAgICAgICAgIHIubWluaW11bSgpIC8g
        MWU2LCByLm1heGltdW0oKSAvIDFlNikKICAgICAgIGluZm8ocGF5bG9hZCkK
        ICAgIHIgPSByYWRpby5nZXRHYWluUmFuZ2UoU09BUFlfU0RSX1JYLCBjaGFu
        KQogICAgcGF5bG9hZCA9ICdnYWluOiB7Oi4yZn0gLSB7Oi4yZn0gZEInLmZv
        cm1hdChyLm1pbmltdW0oKSwgci5tYXhpbXVtKCkpCiAgICBpbmZvKHBheWxv
        YWQpCgoKZGVmIG9uX2ZhdGFsKHBhcmFtKToKICAgIGdsb2JhbCBmYXRhbAog
        ICAgaWYgcGFyYW0ubG93ZXIoKSA9PSAidHJ1ZSI6CiAgICAgICAgZmF0YWwg
        PSBUcnVlCiAgICAgICAgaW5mbygnZmF0YWwga2lsbGluZycpCiAgICBlbHNl
        OgogICAgICAgIGluZm8oJ2JhZCBmYXRhbCBjb21tYW5kJykKCgpkZWYgb25f
        a2lsbChwYXJhbSk6CiAgICBnbG9iYWwga2lsbGVkCiAgICBpZiBwYXJhbS5s
        b3dlcigpID09ICJ0cnVlIjoKICAgICAgICBraWxsZWQgPSBUcnVlCiAgICAg
        ICAgaW5mbygna2lsbGluZyBzdHJlYW0nKQogICAgZWxzZToKICAgICAgICBp
        bmZvKCdiYWQga2lsbCBjb21tYW5kJykKCgpkZWYgb25fcGF1c2UocGFyYW0p
        OgogICAgZ2xvYmFsIHBhdXNlZAogICAgaWYgcGFyYW06CiAgICAgICAgcGF1
        c2VkID0gcGFyYW0ubG93ZXIoKSA9PSAidHJ1ZSIKICAgIGJyb2tlci5wdWJs
        aXNoKGdlbl90b3BpYygicGF1c2UiKSwgJ29uJyBpZiBwYXVzZWQgZWxzZSAn
        b2ZmJykKCgpkZWYgb25fcmF0ZShwYXJhbSk6CiAgICBnbG9iYWwgcmF0ZQog
        ICAgaWYgcGFyYW06CiAgICAgICAgcGFyYW0gPSB0b19mbG9hdChwYXJhbSkK
        ICAgICAgICBpZiBwYXJhbSBpcyBOb25lOgogICAgICAgICAgICBpbmZvKCdi
        YWQgc2FtcGxlIHJhdGUgY29tbWFuZCcpCiAgICAgICAgZWxzZToKICAgICAg
        ICAgICAgcmFkaW8uc2V0U2FtcGxlUmF0ZShTT0FQWV9TRFJfUlgsIDAsIHBh
        cmFtKQogICAgcmF0ZSA9IHJhZGlvLmdldFNhbXBsZVJhdGUoU09BUFlfU0RS
        X1JYLCAwKQogICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJyYXRlIiks
        IGYne3JhdGUvMWUzOi4zZn0gS0h6JykKCgpkZWYgb25fZnJlcShwYXJhbSk6
        CiAgICBpZiBwYXJhbToKICAgICAgICBwYXJhbSA9IHRvX2Zsb2F0KHBhcmFt
        KQogICAgICAgIGlmIHBhcmFtIGlzIE5vbmU6CiAgICAgICAgICAgIGluZm8o
        J2JhZCBmcmVxdWVuY3kgY29tbWFuZCcpCiAgICAgICAgZWxzZToKICAgICAg
        ICAgICAgcmFkaW8uc2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9SWCwgMCwgcGFy
        YW0pCiAgICBmcmVxID0gcmFkaW8uZ2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9S
        WCwgMCkKICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3BpYygiZnJlcSIpLCBm
        J3tmcmVxLzFlNjouNmZ9IE1IeicpCgoKZGVmIG9uX2dhaW4ocGFyYW0pOgog
        ICAgaWYgcGFyYW06CiAgICAgICAgcGFyYW0gPSB0b19mbG9hdChwYXJhbSkK
        ICAgICAgICBpZiBwYXJhbSBpcyBOb25lOgogICAgICAgICAgICBpbmZvKCdi
        YWQgZ2FpbiBjb21tYW5kJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBy
        YWRpby5zZXRHYWluKFNPQVBZX1NEUl9SWCwgMCwgcGFyYW0pCiAgICBnYWlu
        ID0gcmFkaW8uZ2V0R2FpbihTT0FQWV9TRFJfUlgsIDApCiAgICBicm9rZXIu
        cHVibGlzaChnZW5fdG9waWMoImdhaW4iKSwgZid7Z2FpbjouM2d9IGRCJykK
        CgpkZWYgb25fYXV0byhwYXJhbSk6CiAgICBpZiBwYXJhbToKICAgICAgICBy
        YWRpby5zZXRHYWluTW9kZShTT0FQWV9TRFJfUlgsIDAsIHBhcmFtLmxvd2Vy
        KCkgPT0gInRydWUiKQogICAgYWdjID0gcmFkaW8uZ2V0R2Fpbk1vZGUoU09B
        UFlfU0RSX1JYLCAwKQogICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJh
        Z2MiKSwgJ29uJyBpZiBhZ2MgZWxzZSAnb2ZmJykKCgpkZWYgb25fc2V0dGlu
        ZyhrZXksIHBhcmFtKToKICAgIGlmIHBhcmFtOgogICAgICAgIHJhZGlvLndy
        aXRlU2V0dGluZyhrZXksIHBhcmFtKQogICAgdmFsID0gcmFkaW8ucmVhZFNl
        dHRpbmcoa2V5KQogICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKGtleSks
        IHN0cih2YWwpKQoKCmRlZiBvbl9wcHModHMpOgogICAgaWYgdGltZWZpbGUg
        YW5kIG5vdCBwYXVzZWQ6CiAgICAgICAgc2VjID0gc2FtcGxlc190b3RhbCAv
        IHJhdGUKICAgICAgICBkdCA9IGRhdGV0aW1lLnN0cnB0aW1lKHRzLCAiJVkt
        JW0tJWRUJUg6JU06JVMuJWZaIikKICAgICAgICBpZiBkdC5zZWNvbmQgJSBh
        cmdzLnJlZmVzaF9wcHMgPT0gMDoKICAgICAgICAgICAgaW5mbyh0cykKICAg
        ICAgICB0aW1lZmlsZS53cml0ZShmIntzZWM6LjNmfVx0e3NlYzouM2Z9XHR7
        dHN9XG4iKQogICAgICAgIHRpbWVmaWxlLmZsdXNoKCkKCgpkZWYgb25fbWVz
        c2FnZShjbGllbnQsIHVzZXJkYXRhLCBtc2cpOgogICAgcGF5bG9hZCA9IG1z
        Zy5wYXlsb2FkLmRlY29kZSgnbGF0aW4nKS5zdHJpcCgpCiAgICB0cnk6CiAg
        ICAgICAgaWYgcGF5bG9hZCBhbmQgbXNnLnRvcGljID09IGFyZ3MucHBzX3Rv
        cGljOgogICAgICAgICAgICBvbl9wcHMocGF5bG9hZCkKICAgICAgICBpZiBw
        YXlsb2FkIGFuZCBtc2cudG9waWMgPT0gYXJncy50b3BpYzoKICAgICAgICAg
        ICAgY21kLCBfLCBwYXJhbSA9IHBheWxvYWQucGFydGl0aW9uKCcgJykgCiAg
        ICAgICAgICAgIHBhcmFtID0gcGFyYW0uc3RyaXAoKQogICAgICAgICAgICBp
        ZiBjbWQgPT0gJ2knOgogICAgICAgICAgICAgICAgb25faW5mbyhwYXJhbSkK
        ICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ3AnOgogICAgICAgICAgICAgICAg
        b25fcGF1c2UocGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdnJzoK
        ICAgICAgICAgICAgICAgIG9uX2dhaW4ocGFyYW0pCiAgICAgICAgICAgIGVs
        aWYgY21kID09ICdhJzoKICAgICAgICAgICAgICAgIG9uX2F1dG8ocGFyYW0p
        CiAgICAgICAgICAgIGVsaWYgY21kID09ICdyJzoKICAgICAgICAgICAgICAg
        IG9uX3JhdGUocGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdmJzoK
        ICAgICAgICAgICAgICAgIG9uX2ZyZXEocGFyYW0pCiAgICAgICAgICAgIGVs
        aWYgY21kID09ICdrJzoKICAgICAgICAgICAgICAgIG9uX2tpbGwocGFyYW0p
        CiAgICAgICAgICAgIGVsaWYgY21kID09ICdLJzoKICAgICAgICAgICAgICAg
        IG9uX2ZhdGFsKHBhcmFtKQogICAgICAgICAgICBlbGlmIGNtZCA9PSAnZHMn
        OgogICAgICAgICAgICAgICAgaWYgcGFyYW0ubG93ZXIoKSA9PSAiaSI6IHBh
        cmFtID0gIjEiCiAgICAgICAgICAgICAgICBpZiBwYXJhbS5sb3dlcigpID09
        ICJxIjogcGFyYW0gPSAiMiIKICAgICAgICAgICAgICAgIG9uX3NldHRpbmco
        ImRpcmVjdF9zYW1wIiwgcGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09
        ICdpcSc6CiAgICAgICAgICAgICAgICBvbl9zZXR0aW5nKCJpcV9zd2FwIiwg
        cGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdidCc6CiAgICAgICAg
        ICAgICAgICBvbl9zZXR0aW5nKCJiaWFzdGVlIiwgcGFyYW0pCiAgICAgICAg
        ICAgIGVsaWYgY21kID09ICdkYSc6CiAgICAgICAgICAgICAgICBvbl9zZXR0
        aW5nKCJkaWdpdGFsX2FnYyIsIHBhcmFtKQogICAgICAgICAgICBlbGlmIGNt
        ZCA9PSAnb3QnOgogICAgICAgICAgICAgICAgb25fc2V0dGluZygib2Zmc2V0
        X3R1bmUiLCBwYXJhbSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAg
        ICAgIGluZm8oJ3Vua25vd24gY29tbWFuZCcpCiAgICBleGNlcHQgRXhjZXB0
        aW9uIGFzIGU6CiAgICAgICAgaW5mbyhmIkV4Y2VwdGlvbiBvbl9tZXNzYWdl
        KCk6IHtlfSIpCgoKZGVmIG9uX2Nvbm5lY3QoY2xpZW50LCB1c2VyZGF0YSwg
        ZmxhZ3MsIHJjKToKICAgIGNsaWVudC5zdWJzY3JpYmUoZ2VuX3RvcGljKCcj
        JykpCiAgICBjbGllbnQuc3Vic2NyaWJlKGFyZ3MucHBzX3RvcGljKQoKCiMj
        IyMjIyMjIyMjIyMjIwoKZGVmIGluZm8ocGF5bG9hZCk6CiAgICBwcmludChw
        YXlsb2FkLCBmaWxlPXN5cy5zdGRlcnIpCiAgICBpZiBicm9rZXI6CiAgICAg
        ICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJpbmZvIiksIHBheWxvYWQp
        CgoKZGVmIGxvZ19oYW5kbGVyKGxvZ19sZXZlbCwgbG9nX21lc3NhZ2UpOgog
        ICAgaWYgYnJva2VyOgogICAgICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3Bp
        YygibG9nIiksIGxvZ19tZXNzYWdlKQoKCmRlZiB3YXZfaGVhZGVyKHJhdGUs
        IGNoYW5uZWxzPTIsIHNhbXBsZV9ieXRlcz00KToKICAgIHJhdGUgPSBpbnQo
        cmF0ZSkKICAgIGRhdGFfaWQgPSBiJ2RhdGEnCiAgICBkYXRhX3NpemUgPSAw
        eDgwMDAwMDAwCiAgICByaWZmX2lkID0gYidSSUZGJwogICAgcmlmZl9mb3Jt
        YXQgPSBiJ1dBVkUnCiAgICBmbXRfaWQgPSBiJ2ZtdCAnCiAgICBmbXRfc2l6
        ZSA9IDE2CiAgICBmbXRfZm9ybWF0ID0gMyAgICAjIElFRUVfRkxPQVQKICAg
        IGJ1ZiA9IHN0cnVjdC5wYWNrKCc8NHNJNHMnLCByaWZmX2lkLCBkYXRhX3Np
        emUgKyAyMCArIGZtdF9zaXplLCByaWZmX2Zvcm1hdCkKICAgIGJ1ZiArPSBz
        dHJ1Y3QucGFjaygnPDRzSUhIJywgZm10X2lkLCBmbXRfc2l6ZSwgZm10X2Zv
        cm1hdCwgY2hhbm5lbHMpCiAgICBidWYgKz0gc3RydWN0LnBhY2soJzxJSUhI
        JywKICAgICAgICByYXRlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICMg
        MzItYml0CiAgICAgICAgcmF0ZSAqIGNoYW5uZWxzICogc2FtcGxlX2J5dGVz
        LCAjIDMyLWJpdAogICAgICAgIGNoYW5uZWxzICogc2FtcGxlX2J5dGVzLAog
        ICAgICAgIHNhbXBsZV9ieXRlcyAqIDgpCiAgICBidWYgKz0gc3RydWN0LnBh
        Y2soJzw0c0knLCBkYXRhX2lkLCBkYXRhX3NpemUpCiAgICByZXR1cm4gYnVm
        CgoKZGVmIHJhZGlvX2Nvbm5lY3QoKToKICAgIGdsb2JhbCByYWRpbwogICAg
        ZHJpdmVycyA9IFsgZFsnZHJpdmVyJ10gZm9yIGQgaW4gU29hcHlTRFIuRGV2
        aWNlLmVudW1lcmF0ZSgpIF0KICAgIGluZm8oZiJGb3VuZCBkcml2ZXJzOiB7
        ZHJpdmVyc30iKQogICAgZHJpdmVyID0gYXJncy5kcml2ZXIKICAgIGlmIG5v
        dCBkcml2ZXI6CiAgICAgICAgZm9yIHJlcyBpbiBTb2FweVNEUi5EZXZpY2Uu
        ZW51bWVyYXRlKCk6IAogICAgICAgICAgICBkcml2ZXIgPSByZXNbJ2RyaXZl
        ciddCiAgICByYWRpbyA9IFNvYXB5U0RSLkRldmljZShkcml2ZXIpCgoKZGVm
        IHJhZGlvX3NldHRpbmdzKCk6CiAgICBpbmZvKGYiSW5pdGlhbGl6aW5nIHJh
        ZGlvIHNldHRpbmdzIikKICAgIGlmIGFyZ3MuZnJlcToKICAgICAgICByYWRp
        by5zZXRGcmVxdWVuY3koU09BUFlfU0RSX1JYLCAwLCBhcmdzLmZyZXEpCiAg
        ICBpZiBhcmdzLnJhdGU6CiAgICAgICAgcmFkaW8uc2V0U2FtcGxlUmF0ZShT
        T0FQWV9TRFJfUlgsIDAsIGFyZ3MucmF0ZSkKICAgIHJhZGlvLnNldEdhaW5N
        b2RlKFNPQVBZX1NEUl9SWCwgMCwgYXJncy5hZ2MpOwogICAgaWYgYXJncy5n
        YWluOgogICAgICAgIHJhZGlvLnNldEdhaW4oU09BUFlfU0RSX1JYLCAwLCBh
        cmdzLmdhaW4pCiAgICBpZiBhcmdzLmRpcmVjdF9zYW1wOgogICAgICAgIHBh
        cmFtID0gYXJncy5kaXJlY3Rfc2FtcAogICAgICAgIGlmIHBhcmFtLmxvd2Vy
        KCkgPT0gImkiOiBwYXJhbSA9ICIxIgogICAgICAgIGlmIHBhcmFtLmxvd2Vy
        KCkgPT0gInEiOiBwYXJhbSA9ICIyIgogICAgICAgIHJhZGlvLndyaXRlU2V0
        dGluZygiZGlyZWN0X3NhbXAiLCBwYXJhbSkKICAgIGlmIGFyZ3MuaXFfc3dh
        cDoKICAgICAgICByYWRpby53cml0ZVNldHRpbmcoImlxX3N3YXAiLCAidHJ1
        ZSIpCiAgICBpZiBhcmdzLmJpYXN0ZWU6CiAgICAgICAgcmFkaW8ud3JpdGVT
        ZXR0aW5nKCJiaWFzdGVlIiwgInRydWUiKQogICAgaWYgYXJncy5kaWdpdGFs
        X2FnYzoKICAgICAgICByYWRpby53cml0ZVNldHRpbmcoImRpZ2l0YWxfYWdj
        IiwgInRydWUiKQogICAgaWYgYXJncy5kaWdpdGFsX2FnYzoKICAgICAgICBy
        YWRpby53cml0ZVNldHRpbmcoIm9mZnNldF90dW5lIiwgInRydWUiKQoKCmRl
        ZiBtYWluX2luaXQoKToKICAgIGdsb2JhbCBwYXVzZWQsIGtpbGxlZCwgZmF0
        YWwKICAgIGtpbGxlZCA9IEZhbHNlCiAgICBmYXRhbCA9IEZhbHNlCiAgICBw
        YXVzZWQgPSBhcmdzLnBhdXNlCgoKZGVmIGJyb2tlcl9pbml0KCk6CiAgICBn
        bG9iYWwgYnJva2VyLCB0aW1lZmlsZQogICAgdGltZWZpbGUgPSBOb25lCiAg
        ICBicm9rZXIgPSBOb25lCiAgICBpZiBub3QgYXJncy5ub2Jyb2tlcjoKICAg
        ICAgICBpbmZvKGYiQ29ubmVjdGluZyB0byBicm9rZXI6IHthcmdzLmJyb2tl
        cn0iKQogICAgICAgIGJyb2tlciA9IG1xdHQuQ2xpZW50KCkKICAgICAgICBi
        cm9rZXIub25fY29ubmVjdCA9IG9uX2Nvbm5lY3QKICAgICAgICBicm9rZXIu
        b25fbWVzc2FnZSA9IG9uX21lc3NhZ2UKICAgICAgICBicm9rZXIuY29ubmVj
        dChhcmdzLmJyb2tlciwgYXJncy5icm9rZXJfcG9ydCwgYXJncy5icm9rZXJf
        a2VlcGFsaXZlKQogICAgICAgIGJyb2tlci5sb29wX3N0YXJ0KCkKICAgIGlu
        Zm8oJ0luaXRpYWxpemluZycpCgoKZGVmIG1haW4oKToKICAgIGJyb2tlcl9p
        bml0KCkKICAgIFNvYXB5U0RSLnJlZ2lzdGVyTG9nSGFuZGxlcihsb2dfaGFu
        ZGxlcikKICAgIGluaXRpYWxpemVkPSBGYWxzZQogICAgd2hpbGUgVHJ1ZToK
        ICAgICAgICB0cnk6CiAgICAgICAgICAgIG1haW5faW5pdCgpCiAgICAgICAg
        ICAgIHJhZGlvX2Nvbm5lY3QoKQogICAgICAgICAgICBpZiBub3QgaW5pdGlh
        bGl6ZWQ6CiAgICAgICAgICAgICAgICByYWRpb19zZXR0aW5ncygpCiAgICAg
        ICAgICAgIGluaXRpYWxpemVkID0gVHJ1ZQogICAgICAgICAgICByYWRpb19z
        dGFydCgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAg
        ICAgICBpbmZvKGYiRXhjZXB0aW9uIG1haW4oKToge2V9IikKICAgICAgICAg
        ICAgdGltZS5zbGVlcChhcmdzLnJlc3RhcnRfc2Vjb25kcykKCgpkZWYgY2xv
        c2VfZmlsZShmLCBuYW1lKToKICAgIGlmIGY6CiAgICAgICAgaW5mbyhmIkNs
        b3Npbmcge25hbWV9IGZpbGUuIikKICAgICAgICBmLmNsb3NlKCkKCgpkZWYg
        b3Blbl9maWxlcygpOgogICAgZHQgPSBkYXRldGltZS51dGNub3coKQogICAg
        dHMgPSBkdC5zdHJmdGltZSgnJXklbSVkXyVIJU0lUycpCiAgICBmcmVxID0g
        cmFkaW8uZ2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9SWCwgMCkKICAgIGJhc2Vu
        YW1lID0gZiJ7YXJncy5vdXRwdXR9X3t0c31aX3tmcmVxLzFlNjouNmZ9TUh6
        IgogICAgZXh0ID0gJ3R4dCcKICAgIGZpbGVuYW1lID0gZiJ7YmFzZW5hbWV9
        LntleHR9IgogICAgaW5mbyhmIk9wZW5pbmcge2ZpbGVuYW1lfSBmb3IgZ3Bz
        IHBwcyB0aW1lIikKICAgIHRpbWVmaWxlID0gb3BlbihmaWxlbmFtZSwgInci
        KQogICAgZXh0ID0gJ3JhdycgaWYgYXJncy5ub3dhdmUgZWxzZSAnd2F2Jwog
        ICAgZmlsZW5hbWUgPSBmIntiYXNlbmFtZX0ue2V4dH0iCiAgICBpbmZvKGYi
        T3BlbmluZyB7ZmlsZW5hbWV9IGZvciBhdWRpbyIpCiAgICBhdWRpb2ZpbGUg
        PSBvcGVuKGZpbGVuYW1lLCAid2IiKQogICAgaWYgbm90IGFyZ3Mubm93YXZl
        OgogICAgICAgIGF1ZGlvZmlsZS53cml0ZSh3YXZfaGVhZGVyKHJhdGU9cmF0
        ZSkpCiAgICByZXR1cm4gYXVkaW9maWxlLCB0aW1lZmlsZQoKCmRlZiBjbG9z
        ZV9zdHJlYW0oc3RyZWFtKToKICAgIGluZm8oZiJDbG9zaW5nIHJhZGlvIHN0
        cmVhbS4iKQogICAgcmFkaW8uZGVhY3RpdmF0ZVN0cmVhbShzdHJlYW0pIAog
        ICAgcmFkaW8uY2xvc2VTdHJlYW0oc3RyZWFtKQoKCmRlZiByYWRpb19wZWFr
        KHBlYWtfbGV2ZWwpOgogICAgZGIgPSAiezouMWZ9IGRCIi5mb3JtYXQoMjAg
        KiBucC5sb2cxMChwZWFrX2xldmVsICsgMWUtOTkpKQogICAgaWYgYXJncy5t
        ZXRlcjoKICAgICAgICBidWYgPSBmIntkYn1cbiIgaWYgYXJncy5kdW1iIGVs
        c2UgZiJcMzNbMkt7ZGI6PjlzfVxyIgogICAgICAgIHByaW50KGJ1ZiwgZW5k
        PSIiLCBmaWxlPXN5cy5zdGRlcnIpCiAgICBpZiBicm9rZXI6CiAgICAgICAg
        YnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJwZWFrIiksIGRiKQoKCiMjIyMj
        IyMjIyMjIyMjIwoKc29ja19saXN0ID0gW10Kc29ja19zZXJ2ZXI9IE5vbmUK
        CgpkZWYgb3Blbl9jb25uKHNvY2ssIGNsaWVudF9hZGRyZXNzKToKICAgIHNv
        Y2tfbGlzdC5hcHBlbmQoc29jaykKCgpkZWYgY2xvc2VfY29ubihzb2NrKToK
        ICAgIHNvY2tfbGlzdC5yZW1vdmUoc29jaykKICAgIHNvY2suY2xvc2UoKQoK
        CmRlZiBjbG9zZV9zZXJ2ZXIoKToKICAgIGZvciBzb2NrIGluIHNvY2tfbGlz
        dDoKICAgICAgICBzb2NrLmNsb3NlKCkKCgpkZWYgdGNwX2NvbW1hbmQoZGF0
        YSk6CiAgICBjb21tYW5kLCBwYXJhbSA9IHN0cnVjdC51bnBhY2soY29tbWFu
        ZF9mbXQsIGRhdGEpCiAgICBpZiBhcmdzLmZyZWV6ZToKICAgICAgICBwYXNz
        CiAgICBlbGlmIGNvbW1hbmQgPT0gMHgwMToKICAgICAgICBpZiBhcmdzLmRp
        cmVjdF9zYW1wIG9yIGFyZ3Mud3JhcDoKICAgICAgICAgICAgcGFyYW0gPSBu
        cC5hYnMocGFyYW0gLSAxMDBlNikKICAgICAgICBpbmZvKCdzZXRfZnJlcXVl
        bmN5OiB7Oi42Zn0gTUh6Jy5mb3JtYXQocGFyYW0gLyAxZTYpKQogICAgICAg
        IHJhZGlvLnNldEZyZXF1ZW5jeShTT0FQWV9TRFJfUlgsIDAsIHBhcmFtKQog
        ICAgZWxpZiBjb21tYW5kID09IDB4MDI6CiAgICAgICAgaW5mbygnc2V0X3Nh
        bXBsZV9yYXRlOiB7fSBIeicuZm9ybWF0KHBhcmFtKSkKICAgICAgICByYWRp
        by5zZXRTYW1wbGVSYXRlKFNPQVBZX1NEUl9SWCwgMCwgcGFyYW0pCiAgICBl
        bGlmIGNvbW1hbmQgPT0gMHgwMzoKICAgICAgICBpbmZvKCdzZXRfZ2Fpbl9t
        b2RlOiB7fScuZm9ybWF0KHBhcmFtKSkKICAgICAgICByYWRpby5zZXRHYWlu
        TW9kZShTT0FQWV9TRFJfUlgsIDAsIG5vdCBwYXJhbSk7CiAgICBlbGlmIGNv
        bW1hbmQgPT0gMHgwNDoKICAgICAgICBwYXJhbSA9IHBhcmFtIC8gMTAKICAg
        ICAgICBpbmZvKCdzZXRfZ2FpbjogezouMWZ9Jy5mb3JtYXQocGFyYW0pKQog
        ICAgICAgIHJhZGlvLnNldEdhaW4oU09BUFlfU0RSX1JYLCAwLCBwYXJhbSk7
        CiAgICBlbHNlOgogICAgICAgIGluZm8oJ3VtaW1wbGVtZW50ZWQ6IHs6LjFm
        fScuZm9ybWF0KGNvbW1hbmQpKQoKCmRlZiB0Y3Bfc2VydmVyKGRhdGEpOgog
        ICAgaWYgYXJncy5ydGx0Y3A6CiAgICAgICAgZGF0YSA9IChkYXRhICogMTI4
        ICsgMTI4KS5hc3R5cGUoJ0InKQogICAgcmVhZGFibGUsIHdyaXRhYmxlLCBl
        eGNlcHRpb25hbCA9IHNlbGVjdC5zZWxlY3Qoc29ja19saXN0LCBzb2NrX2xp
        c3QsIHNvY2tfbGlzdCwgMCkKICAgIGZvciBzb2NrIGluIHNvY2tfbGlzdDoK
        ICAgICAgICBpZiBzb2NrIGluIGV4Y2VwdGlvbmFsOgogICAgICAgICAgICBj
        bG9zZV9jb25uKHNvY2spCiAgICBmb3Igc29jayBpbiBzb2NrX2xpc3Q6CiAg
        ICAgICAgaWYgc29jayBpbiB3cml0YWJsZToKICAgICAgICAgICAgdHJ5Ogog
        ICAgICAgICAgICAgICAgc29jay5zZW5kYWxsKGRhdGEpCiAgICAgICAgICAg
        IGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICAgICAgY2xvc2VfY29ubihz
        b2NrKQogICAgZm9yIHNvY2sgaW4gc29ja19saXN0OgogICAgICAgIGlmIHNv
        Y2sgaW4gcmVhZGFibGU6CiAgICAgICAgICAgIGlmIHNvY2sgPT0gc29ja19z
        ZXJ2ZXI6CiAgICAgICAgICAgICAgICBjb25uLCBjbGllbnRfYWRkcmVzcyA9
        IHNvY2suYWNjZXB0KCkKICAgICAgICAgICAgICAgIG9wZW5fY29ubihjb25u
        LCBjbGllbnRfYWRkcmVzcykKICAgICAgICAgICAgICAgIGlmIGFyZ3MucnRs
        dGNwOgogICAgICAgICAgICAgICAgICAgIHR1bmVyX251bWJlciA9IDUgIyBS
        ODIwVAogICAgICAgICAgICAgICAgICAgIHR1bmVyX2dhaW5zID0gMjkgIyBS
        ODIwVAogICAgICAgICAgICAgICAgICAgIGRvbmdsZV9pbmZvID0gc3RydWN0
        LnBhY2soJz40c0lJJywgYidSVEwwJywgdHVuZXJfbnVtYmVyLCB0dW5lcl9n
        YWlucykKICAgICAgICAgICAgICAgICAgICBjb25uLnNlbmRhbGwoZG9uZ2xl
        X2luZm8pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBidWYg
        PSBzb2NrLnJlY3YoY29tbWFuZF9zaXplKQogICAgICAgICAgICAgICAgdGNw
        X2NvbW1hbmQoYnVmKQoKCmRlZiBpbml0X3NlcnZlcigpOgogICAgZ2xvYmFs
        IHNvY2tfc2VydmVyLCBzb2NrX2xpc3QKICAgIHNvY2sgPSBzb2NrZXQuc29j
        a2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICBz
        b2NrLnNldHNvY2tvcHQoc29ja2V0LlNPTF9TT0NLRVQsIHNvY2tldC5TT19S
        RVVTRUFERFIsIDEpCiAgICBzb2NrLmJpbmQoKGFyZ3MuaG9zdCwgYXJncy5w
        b3J0KSkKICAgIHNvY2subGlzdGVuKCkKICAgIHNvY2tfbGlzdCA9IFsgc29j
        ayBdCiAgICBzb2NrX3NlcnZlciA9IHNvY2sKCgpkZWYgcmFkaW9fc3RhcnQo
        KToKICAgIGdsb2JhbCByYXRlLCB0aW1lZmlsZSwgc2FtcGxlc190b3RhbAog
        ICAgaWYgbm90IGFyZ3Mubm9zZXJ2ZXI6IAogICAgICAgIGluaXRfc2VydmVy
        KCkKICAgIHJhdGUgPSByYWRpby5nZXRTYW1wbGVSYXRlKFNPQVBZX1NEUl9S
        WCwgMCkKICAgIGRhdGEgPSBucC5hcnJheShbMF0gKiBhcmdzLnBhY2tldF9z
        aXplICogMiwgbnAuZmxvYXQzMikKICAgIHN0cmVhbSA9IHJhZGlvLnNldHVw
        U3RyZWFtKFNPQVBZX1NEUl9SWCwgU09BUFlfU0RSX0NGMzIpCiAgICByYWRp
        by5hY3RpdmF0ZVN0cmVhbShzdHJlYW0pIAogICAgc2FtcGxlc190b3RhbCA9
        IDAKICAgIHBlYWtfbGV2ZWwgPSAwCiAgICBzYW1wbGVfbnVtID0gMAogICAg
        b3V0ZmlsZSA9IE5vbmUKICAgIHRyeToKICAgICAgICB3aGlsZSBub3Qga2ls
        bGVkIGFuZCBub3QgZmF0YWw6CiAgICAgICAgICAgIHJhZGlvLnJlYWRTdHJl
        YW0oc3RyZWFtLCBbZGF0YV0sIGFyZ3MucGFja2V0X3NpemUpCiAgICAgICAg
        ICAgIGlmIG5vdCBwYXVzZWQ6CiAgICAgICAgICAgICAgICBpZiBub3Qgb3V0
        ZmlsZToKICAgICAgICAgICAgICAgICAgICBvdXRmaWxlLCB0aW1lZmlsZSA9
        IG9wZW5fZmlsZXMoKQogICAgICAgICAgICAgICAgc2FtcGxlc190b3RhbCAr
        PSBhcmdzLnBhY2tldF9zaXplCiAgICAgICAgICAgICAgICBvdXRmaWxlLndy
        aXRlKGRhdGEpCiAgICAgICAgICAgIGlmIG5vdCBhcmdzLm5vc2VydmVyOgog
        ICAgICAgICAgICAgICAgdGNwX3NlcnZlcihkYXRhKQoKICAgICAgICAgICAg
        IyBwZWFrIG1ldGVyCiAgICAgICAgICAgIHBlYWtfbGV2ZWwgPSBtYXgocGVh
        a19sZXZlbCwgYWJzKGRhdGEubWluKCkpLCBhYnMoZGF0YS5tYXgoKSkpCiAg
        ICAgICAgICAgIHNhbXBsZV9udW0gKz0gYXJncy5wYWNrZXRfc2l6ZQogICAg
        ICAgICAgICBpZiBzYW1wbGVfbnVtID4gcmF0ZSAqIGFyZ3MucmVmcmVzaDoK
        ICAgICAgICAgICAgICAgIHJhZGlvX3BlYWsocGVha19sZXZlbCkKICAgICAg
        ICAgICAgICAgIHBlYWtfbGV2ZWwgPSAwCiAgICAgICAgICAgICAgICBzYW1w
        bGVfbnVtID0gMAogICAgZXhjZXB0IChLZXlib2FyZEludGVycnVwdCwgU3lz
        dGVtRXJyb3IpIGFzIGU6CiAgICAgICAgaW5mbyhmIkV4Y2VwdGlvbiByYWRp
        b19zdGFydCgpOiB7ZX0iKQogICAgICAgIHRpbWUuc2xlZXAoYXJncy5yZXN0
        YXJ0X3NlY29uZHMpCiAgICBpZiBub3QgYXJncy5ub3NlcnZlcjogCiAgICAg
        ICAgY2xvc2Vfc2VydmVyKCkKICAgIGNsb3NlX2ZpbGUob3V0ZmlsZSwgImF1
        ZGlvIikKICAgIHRpbWVmaWxlID0gY2xvc2VfZmlsZSh0aW1lZmlsZSwgInRp
        bWUiKQogICAgY2xvc2Vfc3RyZWFtKHN0cmVhbSkKICAgIGlmIGZhdGFsOgog
        ICAgICAgIGluZm8oIkZhdGFsIGNvbW1hbmQgZ2l2ZW4sIGtpbGxpbmcgcHJv
        Y2VzcyIpCiAgICAgICAgc3lzLmV4aXQoMSkKCgppZiBfX25hbWVfXyA9PSAn
        X19tYWluX18nOgogICAgYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKICAg
        IG1haW4oKQoK


  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqclient
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgc3lzCmltcG9ydCBhcmdwYXJz
        ZQppbXBvcnQgcGFoby5tcXR0LmNsaWVudCBhcyBtcXR0CgpwYXJzZXIgPSBh
        cmdwYXJzZS5Bcmd1bWVudFBhcnNlcigKICAgIGZvcm1hdHRlcl9jbGFzcz1h
        cmdwYXJzZS5Bcmd1bWVudERlZmF1bHRzSGVscEZvcm1hdHRlcikKcGFyc2Vy
        LmFkZF9hcmd1bWVudCgiLS1icm9rZXIiLCBkZWZhdWx0PSIxMjcuMC4wLjEi
        LCBoZWxwPSdicm9rZXIgaG9zdCcpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0t
        cG9ydCIsIGRlZmF1bHQ9MTg4MywgaGVscD0nYnJva2VyIHBvcnQnKQpwYXJz
        ZXIuYWRkX2FyZ3VtZW50KCItLWtlZXBhbGl2ZSIsIGRlZmF1bHQ9NjAsIGhl
        bHA9J2Jyb2tlciBrZWVwIGFsaXZlJykKcGFyc2VyLmFkZF9hcmd1bWVudCgi
        LS10b3BpYyIsIGRlZmF1bHQ9ImYvdHgiLCBoZWxwPSdjb21tYW5kIHRvcGlj
        JykKCmRlZiBvbl9jb25uZWN0KGNsaWVudCwgdXNlcmRhdGEsIGZsYWdzLCBy
        Yyk6CiAgICBjbGllbnQuc3Vic2NyaWJlKCIjIikKCmRlZiBvbl9tZXNzYWdl
        KGNsaWVudCwgdXNlcmRhdGEsIG1zZyk6CiAgICBwcmludChtc2cudG9waWMg
        KyAiICIgKyBtc2cucGF5bG9hZC5kZWNvZGUoJ2xhdGluJykpCgpkZWYgbWFp
        bigpOgogICAgY2xpZW50ID0gbXF0dC5DbGllbnQoKQogICAgY2xpZW50Lm9u
        X2Nvbm5lY3QgPSBvbl9jb25uZWN0CiAgICBjbGllbnQub25fbWVzc2FnZSA9
        IG9uX21lc3NhZ2UKICAgIGNsaWVudC5jb25uZWN0KGFyZ3MuYnJva2VyLCBh
        cmdzLnBvcnQsIGFyZ3Mua2VlcGFsaXZlKQogICAgY2xpZW50Lmxvb3Bfc3Rh
        cnQoKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBsaW5lID0gbmV4dChzeXMu
        c3RkaW4pLnJzdHJpcCgpCiAgICAgICAgY2xpZW50LnB1Ymxpc2goYXJncy50
        b3BpYywgbGluZSkgCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAg
        YXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKICAgIG1haW4oKQoKCg==



  # output directory

  - become: yes
    file: path={{ fs_path }} state=directory owner={{ user }} group={{ user }}

  - become: yes
    copy:
      dest: /lib/systemd/system/mqsoapy.service
      content: |
        [Service]
        ExecStart=/usr/bin/python3 -u /usr/local/bin/mqsoapy --wrap --rtltcp --pause --output {{ fs_path }}/out
        # WorkingDirectory={{ fs_path }}
        User=george
        Restart=on-failure
        RestartSec=10s
        [Install]
        WantedBy=multi-user.target

  - become: yes
    shell: |
      sudo systemctl enable mqsoapy
      sudo systemctl restart mqsoapy


