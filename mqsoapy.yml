---
  - set_fact:
      fs_path: "{{ fs_path | default('/srv') }}"

  # pip

  - become: yes
    pip:
      name:
      - paho-mqtt

  # code

  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqsoapy
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgb3MsIHN5cywgdGltZQppbXBv
        cnQgc29ja2V0LCBzZWxlY3QKaW1wb3J0IHN0cnVjdAppbXBvcnQgYXJncGFy
        c2UKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBwYWhvLm1xdHQuY2xpZW50
        IGFzIG1xdHQKaW1wb3J0IFNvYXB5U0RSCmZyb20gZGF0ZXRpbWUgaW1wb3J0
        IGRhdGV0aW1lCmZyb20gU29hcHlTRFIgaW1wb3J0IFNPQVBZX1NEUl9SWCwg
        U09BUFlfU0RSX0NGMzIKCmNvbW1hbmRfZm10ID0gIj5CSSIKY29tbWFuZF9z
        aXplID0gc3RydWN0LmNhbGNzaXplKGNvbW1hbmRfZm10KQoKCnBhcnNlciA9
        IGFyZ3BhcnNlLkFyZ3VtZW50UGFyc2VyKAogICAgZm9ybWF0dGVyX2NsYXNz
        PWFyZ3BhcnNlLkFyZ3VtZW50RGVmYXVsdHNIZWxwRm9ybWF0dGVyKQoKIyBi
        cm9rZXIKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1icm9rZXIiLCBkZWZhdWx0
        PSIwLjAuMC4wIiwgaGVscD0nYnJva2VyIGhvc3QnKQpwYXJzZXIuYWRkX2Fy
        Z3VtZW50KCItLWJyb2tlci1wb3J0IiwgZGVmYXVsdD0xODgzLCB0eXBlPWlu
        dCwgaGVscD0nYnJva2VyIHBvcnQnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCIt
        LWJyb2tlci1rZWVwYWxpdmUiLCBkZWZhdWx0PTYwLCB0eXBlPWludCwgaGVs
        cD0nYnJva2VyIGtlZXBhbGl2ZSBzZWNvbmRzJykKcGFyc2VyLmFkZF9hcmd1
        bWVudCgiLS10b3BpYyIsIGRlZmF1bHQ9ImYvdHgiLCBoZWxwPSdtcXR0IHRv
        cGljIGZvciBjb21tYW5kJykKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1wcHMt
        dG9waWMiLCBkZWZhdWx0PSJwcHMiLCBoZWxwPSdtcXR0IHRvcGljIGZvciBn
        cHMgcHBzIHRpbWUnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW5vYnJva2Vy
        IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZGlzYWJsZSBtcXR0IGJy
        b2tlciIpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcmVmcmVzaC1wcHMiLCBk
        ZWZhdWx0PTEwLCB0eXBlPWludCwgaGVscD0ncHBzIHJlZnJlc2ggaW4gc2Vj
        b25kcycpCgojIHNvYXB5CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tZHJpdmVy
        IiwgaGVscD0nbmFtZSBvZiBkcml2ZXInKQpwYXJzZXIuYWRkX2FyZ3VtZW50
        KCItLXBhY2tldC1zaXplIiwgZGVmYXVsdD0xMDI0LCB0eXBlPWludCwgaGVs
        cD0ncGFja2V0IHNpemUnKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWZyZXEi
        LCB0eXBlPW5wLmZsb2F0LCBoZWxwPSJjZW50ZXIgZnJlcXVlbmN5IGluIGhl
        cnR6IikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1yYXRlIiwgdHlwZT1ucC5m
        bG9hdCwgaGVscD0ic2FtcGxlIHJhdGUgaW4gaGVydHoiKQpwYXJzZXIuYWRk
        X2FyZ3VtZW50KCItLWdhaW4iLCB0eXBlPW5wLmZsb2F0LCBoZWxwPSJmcm9u
        dCBlbmQgZ2FpbiBpbiBkQiIpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tYWdj
        IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZW5hYmxlIEFHQyIpCgoj
        IHNvYXB5IGFyZ1N0cmluZwpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWRpcmVj
        dC1zYW1wIiwgaGVscD0iMSBvciBpPUksIDIgb3IgcT1RIGNoYW5uZWwiKQpw
        YXJzZXIuYWRkX2FyZ3VtZW50KCItLWlxLXN3YXAiLCBhY3Rpb249InN0b3Jl
        X3RydWUiLCBoZWxwPSJzd2FwIElRIHNpZ25hbHMiKQpwYXJzZXIuYWRkX2Fy
        Z3VtZW50KCItLWJpYXN0ZWUiLCBhY3Rpb249InN0b3JlX3RydWUiLCBoZWxw
        PSJlbmFibGUgYmlhcyB0ZWUiKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWRp
        Z2l0YWwtYWdjIiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgaGVscD0iZW5hYmxl
        IGRpZ2l0YWwgQUdDIikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1vZmZzZXQt
        dHVuZSIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9ImVuYWJsZSBvZmZz
        ZXQgdHVuZSIpCgojIG90aGVyCnBhcnNlci5hZGRfYXJndW1lbnQoIi0tb3V0
        cHV0IiwgZGVmYXVsdD0ib3V0IiwgaGVscD0id3JpdGUgQ0YzMiBzYW1wbGVz
        IHRvIGZpbGUiKQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLW5vd2F2ZSIsIGFj
        dGlvbj0ic3RvcmVfdHJ1ZSIsIGhlbHA9ImRpc2FibGUgV0FWIGhlYWRlciIp
        CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcGF1c2UiLCBhY3Rpb249InN0b3Jl
        X3RydWUiLCBoZWxwPSJwYXVzZSBvdXRwdXQiKQpwYXJzZXIuYWRkX2FyZ3Vt
        ZW50KCItLXJlc3RhcnQtc2Vjb25kcyIsIGRlZmF1bHQ9MTAsIGhlbHA9InJl
        c3RhcnQgZGVsYXkgaW4gc2Vjb25kcyIpCgojIHBlYWsgbWV0ZXIKcGFyc2Vy
        LmFkZF9hcmd1bWVudCgiLS1yZWZyZXNoIiwgZGVmYXVsdD01LCB0eXBlPWlu
        dCwgaGVscD0icGVhayBtZXRlciByZWZyZXNoIGluIHNlY29uZHMiKQpwYXJz
        ZXIuYWRkX2FyZ3VtZW50KCItLW1ldGVyIiwgYWN0aW9uPSJzdG9yZV90cnVl
        IiwgaGVscD0iZW5hYmxlIGNvbnNvbGUgcGVhayBtZXRlciIpCnBhcnNlci5h
        ZGRfYXJndW1lbnQoIi0tZHVtYiIsIGFjdGlvbj0ic3RvcmVfdHJ1ZSIsIGhl
        bHA9ImVuYWJsZSBkdW1iIHRlcm1pbmFsIGNvbnNvbGUiKQogCiMgdGNwIHNl
        cnZlcgpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLWhvc3QiLCBkZWZhdWx0PSIw
        LjAuMC4wIiwgaGVscD0iQ0YzMiB0Y3Agc2VydmVyIGhvc3QgYWRkcmVzcyIp
        CnBhcnNlci5hZGRfYXJndW1lbnQoIi0tcG9ydCIsIHR5cGU9aW50LCBkZWZh
        dWx0PTEyMzQsIGhlbHA9IkNGMzIgdGNwIHNlcnZlciBwb3J0IGFkZHJlc3Mi
        KQpwYXJzZXIuYWRkX2FyZ3VtZW50KCItLXJ0bHRjcCIsIGFjdGlvbj0ic3Rv
        cmVfdHJ1ZSIsIGhlbHA9ImVuYWJsZSBDVTggcnRsdGNwIHNlcnZlciBtb2Rl
        IikKcGFyc2VyLmFkZF9hcmd1bWVudCgiLS1ub3NlcnZlciIsIGFjdGlvbj0i
        c3RvcmVfdHJ1ZSIsIGhlbHA9ImRpc2FibGUgdGNwIHNlcnZlciIpCnBhcnNl
        ci5hZGRfYXJndW1lbnQoIi0tZnJlZXplIiwgYWN0aW9uPSJzdG9yZV90cnVl
        IiwgaGVscD0iZnJlZXplIHRjcCBzZXJ2ZXIgc2V0dGluZ3MiKQpwYXJzZXIu
        YWRkX2FyZ3VtZW50KCItLXdyYXAiLCBhY3Rpb249InN0b3JlX3RydWUiLCBo
        ZWxwPSJ3cmFwIDAgSHogdG8gMTAwIE1IeiIpCgoKZGVmIGdlbl90b3BpYyhu
        YW1lPU5vbmUpOgogICAgZCA9IGFyZ3MudG9waWMuc3BsaXQoJy8nKVs6LTFd
        CiAgICBpZiBuYW1lIGlzIG5vdCBOb25lOgogICAgICAgIGQuYXBwZW5kKG5h
        bWUpCiAgICByZXR1cm4gJy8nLmpvaW4oZCkKCgpkZWYgdG9fZmxvYXQocGFy
        YW0pOgogICAgdHJ5OgogICAgICAgIHJldHVybiBmbG9hdChwYXJhbSkKICAg
        IGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHBhc3MKCgojIyMjIyMjIyMj
        IyMKCmRlZiBvbl9pbmZvKHBhcmFtKToKICAgIGNoYW4gPSAwCiAgICBmb3Ig
        ciBpbiByYWRpby5nZXRTYW1wbGVSYXRlUmFuZ2UoU09BUFlfU0RSX1JYLCBj
        aGFuKToKICAgICAgIHBheWxvYWQgPSAncmF0ZTogezouM2Z9IEtIeicuZm9y
        bWF0KHIubWluaW11bSgpIC8gMWUzKQogICAgICAgaW5mbyhwYXlsb2FkKQog
        ICAgZm9yIHIgaW4gcmFkaW8uZ2V0RnJlcXVlbmN5UmFuZ2UoU09BUFlfU0RS
        X1JYLCBjaGFuKToKICAgICAgIHBheWxvYWQgPSAnZnJlcTogezouNmZ9IC0g
        ezouNmZ9IE1IeicuZm9ybWF0KAogICAgICAgICAgIHIubWluaW11bSgpIC8g
        MWU2LCByLm1heGltdW0oKSAvIDFlNikKICAgICAgIGluZm8ocGF5bG9hZCkK
        ICAgIHIgPSByYWRpby5nZXRHYWluUmFuZ2UoU09BUFlfU0RSX1JYLCBjaGFu
        KQogICAgcGF5bG9hZCA9ICdnYWluOiB7Oi4yZn0gLSB7Oi4yZn0gZEInLmZv
        cm1hdChyLm1pbmltdW0oKSwgci5tYXhpbXVtKCkpCiAgICBpbmZvKHBheWxv
        YWQpCgoKZGVmIG9uX2ZhdGFsKHBhcmFtKToKICAgIGdsb2JhbCBmYXRhbAog
        ICAgaWYgcGFyYW0ubG93ZXIoKSA9PSAidHJ1ZSI6CiAgICAgICAgZmF0YWwg
        PSBUcnVlCiAgICAgICAgaW5mbygnZmF0YWwga2lsbGluZycpCiAgICBlbHNl
        OgogICAgICAgIGluZm8oJ2JhZCBmYXRhbCBjb21tYW5kJykKCgpkZWYgb25f
        a2lsbChwYXJhbSk6CiAgICBnbG9iYWwga2lsbGVkCiAgICBpZiBwYXJhbS5s
        b3dlcigpID09ICJ0cnVlIjoKICAgICAgICBraWxsZWQgPSBUcnVlCiAgICAg
        ICAgaW5mbygna2lsbGluZyBzdHJlYW0nKQogICAgZWxzZToKICAgICAgICBp
        bmZvKCdiYWQga2lsbCBjb21tYW5kJykKCgpkZWYgb25fcGF1c2UocGFyYW0p
        OgogICAgZ2xvYmFsIHBhdXNlZAogICAgaWYgcGFyYW06CiAgICAgICAgcGF1
        c2VkID0gcGFyYW0ubG93ZXIoKSA9PSAidHJ1ZSIKICAgIGJyb2tlci5wdWJs
        aXNoKGdlbl90b3BpYygicGF1c2UiKSwgJ29uJyBpZiBwYXVzZWQgZWxzZSAn
        b2ZmJykKCgpkZWYgb25fcmF0ZShwYXJhbSk6CiAgICBnbG9iYWwgcmF0ZQog
        ICAgaWYgcGFyYW06CiAgICAgICAgcGFyYW0gPSB0b19mbG9hdChwYXJhbSkK
        ICAgICAgICBpZiBwYXJhbSBpcyBOb25lOgogICAgICAgICAgICBpbmZvKCdi
        YWQgc2FtcGxlIHJhdGUgY29tbWFuZCcpCiAgICAgICAgZWxzZToKICAgICAg
        ICAgICAgcmFkaW8uc2V0U2FtcGxlUmF0ZShTT0FQWV9TRFJfUlgsIDAsIHBh
        cmFtKQogICAgcmF0ZSA9IHJhZGlvLmdldFNhbXBsZVJhdGUoU09BUFlfU0RS
        X1JYLCAwKQogICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJyYXRlIiks
        IGYne3JhdGUvMWUzOi4zZn0gS0h6JykKCgpkZWYgb25fZnJlcShwYXJhbSk6
        CiAgICBpZiBwYXJhbToKICAgICAgICBwYXJhbSA9IHRvX2Zsb2F0KHBhcmFt
        KQogICAgICAgIGlmIHBhcmFtIGlzIE5vbmU6CiAgICAgICAgICAgIGluZm8o
        J2JhZCBmcmVxdWVuY3kgY29tbWFuZCcpCiAgICAgICAgZWxzZToKICAgICAg
        ICAgICAgcmFkaW8uc2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9SWCwgMCwgcGFy
        YW0pCiAgICBmcmVxID0gcmFkaW8uZ2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9S
        WCwgMCkKICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3BpYygiZnJlcSIpLCBm
        J3tmcmVxLzFlNjouNmZ9IE1IeicpCgoKZGVmIG9uX2dhaW4ocGFyYW0pOgog
        ICAgaWYgcGFyYW06CiAgICAgICAgcGFyYW0gPSB0b19mbG9hdChwYXJhbSkK
        ICAgICAgICBpZiBwYXJhbSBpcyBOb25lOgogICAgICAgICAgICBpbmZvKCdi
        YWQgZ2FpbiBjb21tYW5kJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBy
        YWRpby5zZXRHYWluKFNPQVBZX1NEUl9SWCwgMCwgcGFyYW0pCiAgICBnYWlu
        ID0gcmFkaW8uZ2V0R2FpbihTT0FQWV9TRFJfUlgsIDApCiAgICBicm9rZXIu
        cHVibGlzaChnZW5fdG9waWMoImdhaW4iKSwgZid7Z2FpbjouM2d9IGRCJykK
        CgpkZWYgb25fYXV0byhwYXJhbSk6CiAgICBpZiBwYXJhbToKICAgICAgICBy
        YWRpby5zZXRHYWluTW9kZShTT0FQWV9TRFJfUlgsIDAsIHBhcmFtLmxvd2Vy
        KCkgPT0gInRydWUiKQogICAgYWdjID0gcmFkaW8uZ2V0R2Fpbk1vZGUoU09B
        UFlfU0RSX1JYLCAwKQogICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJh
        Z2MiKSwgJ29uJyBpZiBhZ2MgZWxzZSAnb2ZmJykKCgpkZWYgb25fc2V0dGlu
        ZyhrZXksIHBhcmFtKToKICAgIGlmIHBhcmFtOgogICAgICAgIHJhZGlvLndy
        aXRlU2V0dGluZyhrZXksIHBhcmFtKQogICAgdmFsID0gcmFkaW8ucmVhZFNl
        dHRpbmcoa2V5KQogICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKGtleSks
        IHN0cih2YWwpKQoKCmRlZiBvbl9wcHModHMpOgogICAgaWYgdGltZWZpbGUg
        YW5kIG5vdCBwYXVzZWQ6CiAgICAgICAgc2VjID0gc2FtcGxlc190b3RhbCAv
        IHJhdGUKICAgICAgICBkdCA9IGRhdGV0aW1lLnN0cnB0aW1lKHRzLCAiJVkt
        JW0tJWRUJUg6JU06JVMuJWZaIikKICAgICAgICBpZiBkdC5zZWNvbmQgJSBh
        cmdzLnJlZmVzaF9wcHMgPT0gMDoKICAgICAgICAgICAgaW5mbyh0cykKICAg
        ICAgICB0aW1lZmlsZS53cml0ZShmIntzZWM6LjNmfVx0e3NlYzouM2Z9XHR7
        dHN9XG4iKQogICAgICAgIHRpbWVmaWxlLmZsdXNoKCkKCgpkZWYgb25fbWVz
        c2FnZShjbGllbnQsIHVzZXJkYXRhLCBtc2cpOgogICAgcGF5bG9hZCA9IG1z
        Zy5wYXlsb2FkLmRlY29kZSgnbGF0aW4nKS5zdHJpcCgpCiAgICB0cnk6CiAg
        ICAgICAgaWYgcGF5bG9hZCBhbmQgbXNnLnRvcGljID09IGFyZ3MucHBzX3Rv
        cGljOgogICAgICAgICAgICBvbl9wcHMocGF5bG9hZCkKICAgICAgICBpZiBw
        YXlsb2FkIGFuZCBtc2cudG9waWMgPT0gYXJncy50b3BpYzoKICAgICAgICAg
        ICAgY21kLCBfLCBwYXJhbSA9IHBheWxvYWQucGFydGl0aW9uKCcgJykgCiAg
        ICAgICAgICAgIHBhcmFtID0gcGFyYW0uc3RyaXAoKQogICAgICAgICAgICBp
        ZiBjbWQgPT0gJ2knOgogICAgICAgICAgICAgICAgb25faW5mbyhwYXJhbSkK
        ICAgICAgICAgICAgZWxpZiBjbWQgPT0gJ3AnOgogICAgICAgICAgICAgICAg
        b25fcGF1c2UocGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdnJzoK
        ICAgICAgICAgICAgICAgIG9uX2dhaW4ocGFyYW0pCiAgICAgICAgICAgIGVs
        aWYgY21kID09ICdhJzoKICAgICAgICAgICAgICAgIG9uX2F1dG8ocGFyYW0p
        CiAgICAgICAgICAgIGVsaWYgY21kID09ICdyJzoKICAgICAgICAgICAgICAg
        IG9uX3JhdGUocGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdmJzoK
        ICAgICAgICAgICAgICAgIG9uX2ZyZXEocGFyYW0pCiAgICAgICAgICAgIGVs
        aWYgY21kID09ICdrJzoKICAgICAgICAgICAgICAgIG9uX2tpbGwocGFyYW0p
        CiAgICAgICAgICAgIGVsaWYgY21kID09ICdLJzoKICAgICAgICAgICAgICAg
        IG9uX2ZhdGFsKHBhcmFtKQogICAgICAgICAgICBlbGlmIGNtZCA9PSAnZHMn
        OgogICAgICAgICAgICAgICAgaWYgcGFyYW0ubG93ZXIoKSA9PSAiaSI6IHBh
        cmFtID0gIjEiCiAgICAgICAgICAgICAgICBpZiBwYXJhbS5sb3dlcigpID09
        ICJxIjogcGFyYW0gPSAiMiIKICAgICAgICAgICAgICAgIG9uX3NldHRpbmco
        ImRpcmVjdF9zYW1wIiwgcGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09
        ICdpcSc6CiAgICAgICAgICAgICAgICBvbl9zZXR0aW5nKCJpcV9zd2FwIiwg
        cGFyYW0pCiAgICAgICAgICAgIGVsaWYgY21kID09ICdidCc6CiAgICAgICAg
        ICAgICAgICBvbl9zZXR0aW5nKCJiaWFzdGVlIiwgcGFyYW0pCiAgICAgICAg
        ICAgIGVsaWYgY21kID09ICdkYSc6CiAgICAgICAgICAgICAgICBvbl9zZXR0
        aW5nKCJkaWdpdGFsX2FnYyIsIHBhcmFtKQogICAgICAgICAgICBlbGlmIGNt
        ZCA9PSAnb3QnOgogICAgICAgICAgICAgICAgb25fc2V0dGluZygib2Zmc2V0
        X3R1bmUiLCBwYXJhbSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAg
        ICAgIGluZm8oJ3Vua25vd24gY29tbWFuZCcpCiAgICBleGNlcHQgRXhjZXB0
        aW9uIGFzIGU6CiAgICAgICAgaW5mbyhmIkV4Y2VwdGlvbiBvbl9tZXNzYWdl
        KCk6IHtlfSIpCgoKZGVmIG9uX2Nvbm5lY3QoY2xpZW50LCB1c2VyZGF0YSwg
        ZmxhZ3MsIHJjKToKICAgIGNsaWVudC5zdWJzY3JpYmUoZ2VuX3RvcGljKCcj
        JykpCiAgICBjbGllbnQuc3Vic2NyaWJlKGFyZ3MucHBzX3RvcGljKQoKCiMj
        IyMjIyMjIyMjIyMjIwoKZGVmIGluZm8ocGF5bG9hZCk6CiAgICBwcmludChw
        YXlsb2FkLCBmaWxlPXN5cy5zdGRlcnIpCiAgICBpZiBicm9rZXI6CiAgICAg
        ICAgYnJva2VyLnB1Ymxpc2goZ2VuX3RvcGljKCJpbmZvIiksIHBheWxvYWQp
        CgoKZGVmIGxvZ19oYW5kbGVyKGxvZ19sZXZlbCwgbG9nX21lc3NhZ2UpOgog
        ICAgaWYgYnJva2VyOgogICAgICAgIGJyb2tlci5wdWJsaXNoKGdlbl90b3Bp
        YygibG9nIiksIGxvZ19tZXNzYWdlKQoKCmRlZiB3YXZfaGVhZGVyKHJhdGUs
        IGNoYW5uZWxzPTIsIHNhbXBsZV9ieXRlcz00KToKICAgIHJhdGUgPSBpbnQo
        cmF0ZSkKICAgIGRhdGFfaWQgPSBiJ2RhdGEnCiAgICBkYXRhX3NpemUgPSAw
        eDgwMDAwMDAwCiAgICByaWZmX2lkID0gYidSSUZGJwogICAgcmlmZl9mb3Jt
        YXQgPSBiJ1dBVkUnCiAgICBmbXRfaWQgPSBiJ2ZtdCAnCiAgICBmbXRfc2l6
        ZSA9IDE2CiAgICBmbXRfZm9ybWF0ID0gMyAgICAjIElFRUVfRkxPQVQKICAg
        IGJ1ZiA9IHN0cnVjdC5wYWNrKCc8NHNJNHMnLCByaWZmX2lkLCBkYXRhX3Np
        emUgKyAyMCArIGZtdF9zaXplLCByaWZmX2Zvcm1hdCkKICAgIGJ1ZiArPSBz
        dHJ1Y3QucGFjaygnPDRzSUhIJywgZm10X2lkLCBmbXRfc2l6ZSwgZm10X2Zv
        cm1hdCwgY2hhbm5lbHMpCiAgICBidWYgKz0gc3RydWN0LnBhY2soJzxJSUhI
        JywKICAgICAgICByYXRlLCAgICAgICAgICAgICAgICAgICAgICAgICAgICMg
        MzItYml0CiAgICAgICAgcmF0ZSAqIGNoYW5uZWxzICogc2FtcGxlX2J5dGVz
        LCAjIDMyLWJpdAogICAgICAgIGNoYW5uZWxzICogc2FtcGxlX2J5dGVzLAog
        ICAgICAgIHNhbXBsZV9ieXRlcyAqIDgpCiAgICBidWYgKz0gc3RydWN0LnBh
        Y2soJzw0c0knLCBkYXRhX2lkLCBkYXRhX3NpemUpCiAgICByZXR1cm4gYnVm
        CgoKZGVmIHJhZGlvX2Nvbm5lY3QoKToKICAgIGdsb2JhbCByYWRpbwogICAg
        ZHJpdmVycyA9IFsgZFsnZHJpdmVyJ10gZm9yIGQgaW4gU29hcHlTRFIuRGV2
        aWNlLmVudW1lcmF0ZSgpIF0KICAgIGluZm8oZiJGb3VuZCBkcml2ZXJzOiB7
        ZHJpdmVyc30iKQogICAgZHJpdmVyID0gYXJncy5kcml2ZXIKICAgIGlmIG5v
        dCBkcml2ZXI6CiAgICAgICAgZm9yIHJlcyBpbiBTb2FweVNEUi5EZXZpY2Uu
        ZW51bWVyYXRlKCk6IAogICAgICAgICAgICBkcml2ZXIgPSByZXNbJ2RyaXZl
        ciddCiAgICByYWRpbyA9IFNvYXB5U0RSLkRldmljZSh7ICdkcml2ZXInOiBk
        cml2ZXIgfSkKCgpkZWYgcmFkaW9fc2V0dGluZ3MoKToKICAgIGluZm8oZiJJ
        bml0aWFsaXppbmcgcmFkaW8gc2V0dGluZ3MiKQogICAgaWYgYXJncy5mcmVx
        OgogICAgICAgIHJhZGlvLnNldEZyZXF1ZW5jeShTT0FQWV9TRFJfUlgsIDAs
        IGFyZ3MuZnJlcSkKICAgIGlmIGFyZ3MucmF0ZToKICAgICAgICByYWRpby5z
        ZXRTYW1wbGVSYXRlKFNPQVBZX1NEUl9SWCwgMCwgYXJncy5yYXRlKQogICAg
        cmFkaW8uc2V0R2Fpbk1vZGUoU09BUFlfU0RSX1JYLCAwLCBhcmdzLmFnYyk7
        CiAgICBpZiBhcmdzLmdhaW46CiAgICAgICAgcmFkaW8uc2V0R2FpbihTT0FQ
        WV9TRFJfUlgsIDAsIGFyZ3MuZ2FpbikKICAgIGlmIGFyZ3MuZGlyZWN0X3Nh
        bXA6CiAgICAgICAgcGFyYW0gPSBhcmdzLmRpcmVjdF9zYW1wCiAgICAgICAg
        aWYgcGFyYW0ubG93ZXIoKSA9PSAiaSI6IHBhcmFtID0gIjEiCiAgICAgICAg
        aWYgcGFyYW0ubG93ZXIoKSA9PSAicSI6IHBhcmFtID0gIjIiCiAgICAgICAg
        cmFkaW8ud3JpdGVTZXR0aW5nKCJkaXJlY3Rfc2FtcCIsIHBhcmFtKQogICAg
        aWYgYXJncy5pcV9zd2FwOgogICAgICAgIHJhZGlvLndyaXRlU2V0dGluZygi
        aXFfc3dhcCIsICJ0cnVlIikKICAgIGlmIGFyZ3MuYmlhc3RlZToKICAgICAg
        ICByYWRpby53cml0ZVNldHRpbmcoImJpYXN0ZWUiLCAidHJ1ZSIpCiAgICBp
        ZiBhcmdzLmRpZ2l0YWxfYWdjOgogICAgICAgIHJhZGlvLndyaXRlU2V0dGlu
        ZygiZGlnaXRhbF9hZ2MiLCAidHJ1ZSIpCiAgICBpZiBhcmdzLmRpZ2l0YWxf
        YWdjOgogICAgICAgIHJhZGlvLndyaXRlU2V0dGluZygib2Zmc2V0X3R1bmUi
        LCAidHJ1ZSIpCgoKZGVmIG1haW5faW5pdCgpOgogICAgZ2xvYmFsIHBhdXNl
        ZCwga2lsbGVkLCBmYXRhbAogICAga2lsbGVkID0gRmFsc2UKICAgIGZhdGFs
        ID0gRmFsc2UKICAgIHBhdXNlZCA9IGFyZ3MucGF1c2UKCgpkZWYgYnJva2Vy
        X2luaXQoKToKICAgIGdsb2JhbCBicm9rZXIsIHRpbWVmaWxlCiAgICB0aW1l
        ZmlsZSA9IE5vbmUKICAgIGJyb2tlciA9IE5vbmUKICAgIGlmIG5vdCBhcmdz
        Lm5vYnJva2VyOgogICAgICAgIGluZm8oZiJDb25uZWN0aW5nIHRvIGJyb2tl
        cjoge2FyZ3MuYnJva2VyfSIpCiAgICAgICAgYnJva2VyID0gbXF0dC5DbGll
        bnQoKQogICAgICAgIGJyb2tlci5vbl9jb25uZWN0ID0gb25fY29ubmVjdAog
        ICAgICAgIGJyb2tlci5vbl9tZXNzYWdlID0gb25fbWVzc2FnZQogICAgICAg
        IGJyb2tlci5jb25uZWN0KGFyZ3MuYnJva2VyLCBhcmdzLmJyb2tlcl9wb3J0
        LCBhcmdzLmJyb2tlcl9rZWVwYWxpdmUpCiAgICAgICAgYnJva2VyLmxvb3Bf
        c3RhcnQoKQogICAgaW5mbygnSW5pdGlhbGl6aW5nJykKCgpkZWYgbWFpbigp
        OgogICAgYnJva2VyX2luaXQoKQogICAgU29hcHlTRFIucmVnaXN0ZXJMb2dI
        YW5kbGVyKGxvZ19oYW5kbGVyKQogICAgaW5pdGlhbGl6ZWQ9IEZhbHNlCiAg
        ICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgbWFpbl9p
        bml0KCkKICAgICAgICAgICAgcmFkaW9fY29ubmVjdCgpCiAgICAgICAgICAg
        IGlmIG5vdCBpbml0aWFsaXplZDoKICAgICAgICAgICAgICAgIHJhZGlvX3Nl
        dHRpbmdzKCkKICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSBUcnVlCiAgICAg
        ICAgICAgIHJhZGlvX3N0YXJ0KCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9u
        IGFzIGU6CiAgICAgICAgICAgIGluZm8oZiJFeGNlcHRpb24gbWFpbigpOiB7
        ZX0iKQogICAgICAgICAgICB0aW1lLnNsZWVwKGFyZ3MucmVzdGFydF9zZWNv
        bmRzKQoKCmRlZiBjbG9zZV9maWxlKGYsIG5hbWUpOgogICAgaWYgZjoKICAg
        ICAgICBpbmZvKGYiQ2xvc2luZyB7bmFtZX0gZmlsZS4iKQogICAgICAgIGYu
        Y2xvc2UoKQoKCmRlZiBvcGVuX2ZpbGVzKCk6CiAgICBkdCA9IGRhdGV0aW1l
        LnV0Y25vdygpCiAgICB0cyA9IGR0LnN0cmZ0aW1lKCcleSVtJWRfJUglTSVT
        JykKICAgIGZyZXEgPSByYWRpby5nZXRGcmVxdWVuY3koU09BUFlfU0RSX1JY
        LCAwKQogICAgYmFzZW5hbWUgPSBmInthcmdzLm91dHB1dH1fe3RzfVpfe2Zy
        ZXEvMWU2Oi42Zn1NSHoiCiAgICBleHQgPSAndHh0JwogICAgZmlsZW5hbWUg
        PSBmIntiYXNlbmFtZX0ue2V4dH0iCiAgICBpbmZvKGYiT3BlbmluZyB7Zmls
        ZW5hbWV9IGZvciBncHMgcHBzIHRpbWUiKQogICAgdGltZWZpbGUgPSBvcGVu
        KGZpbGVuYW1lLCAidyIpCiAgICBleHQgPSAncmF3JyBpZiBhcmdzLm5vd2F2
        ZSBlbHNlICd3YXYnCiAgICBmaWxlbmFtZSA9IGYie2Jhc2VuYW1lfS57ZXh0
        fSIKICAgIGluZm8oZiJPcGVuaW5nIHtmaWxlbmFtZX0gZm9yIGF1ZGlvIikK
        ICAgIGF1ZGlvZmlsZSA9IG9wZW4oZmlsZW5hbWUsICJ3YiIpCiAgICBpZiBu
        b3QgYXJncy5ub3dhdmU6CiAgICAgICAgYXVkaW9maWxlLndyaXRlKHdhdl9o
        ZWFkZXIocmF0ZT1yYXRlKSkKICAgIHJldHVybiBhdWRpb2ZpbGUsIHRpbWVm
        aWxlCgoKZGVmIGNsb3NlX3N0cmVhbShzdHJlYW0pOgogICAgaW5mbyhmIkNs
        b3NpbmcgcmFkaW8gc3RyZWFtLiIpCiAgICByYWRpby5kZWFjdGl2YXRlU3Ry
        ZWFtKHN0cmVhbSkgCiAgICByYWRpby5jbG9zZVN0cmVhbShzdHJlYW0pCgoK
        ZGVmIHJhZGlvX3BlYWsocGVha19sZXZlbCk6CiAgICBkYiA9ICJ7Oi4xZn0g
        ZEIiLmZvcm1hdCgyMCAqIG5wLmxvZzEwKHBlYWtfbGV2ZWwgKyAxZS05OSkp
        CiAgICBpZiBhcmdzLm1ldGVyOgogICAgICAgIGJ1ZiA9IGYie2RifVxuIiBp
        ZiBhcmdzLmR1bWIgZWxzZSBmIlwzM1syS3tkYjo+OXN9XHIiCiAgICAgICAg
        cHJpbnQoYnVmLCBlbmQ9IiIsIGZpbGU9c3lzLnN0ZGVycikKICAgIGlmIGJy
        b2tlcjoKICAgICAgICBicm9rZXIucHVibGlzaChnZW5fdG9waWMoInBlYWsi
        KSwgZGIpCgoKIyMjIyMjIyMjIyMjIyMjCgpzb2NrX2xpc3QgPSBbXQpzb2Nr
        X3NlcnZlcj0gTm9uZQoKCmRlZiBvcGVuX2Nvbm4oc29jaywgY2xpZW50X2Fk
        ZHJlc3MpOgogICAgc29ja19saXN0LmFwcGVuZChzb2NrKQoKCmRlZiBjbG9z
        ZV9jb25uKHNvY2spOgogICAgc29ja19saXN0LnJlbW92ZShzb2NrKQogICAg
        c29jay5jbG9zZSgpCgoKZGVmIGNsb3NlX3NlcnZlcigpOgogICAgZm9yIHNv
        Y2sgaW4gc29ja19saXN0OgogICAgICAgIHNvY2suY2xvc2UoKQoKCmRlZiB0
        Y3BfY29tbWFuZChkYXRhKToKICAgIGNvbW1hbmQsIHBhcmFtID0gc3RydWN0
        LnVucGFjayhjb21tYW5kX2ZtdCwgZGF0YSkKICAgIGlmIGFyZ3MuZnJlZXpl
        OgogICAgICAgIHBhc3MKICAgIGVsaWYgY29tbWFuZCA9PSAweDAxOgogICAg
        ICAgIGlmIGFyZ3MuZGlyZWN0X3NhbXAgb3IgYXJncy53cmFwOgogICAgICAg
        ICAgICBwYXJhbSA9IG5wLmFicyhwYXJhbSAtIDEwMGU2KQogICAgICAgIGlu
        Zm8oJ3NldF9mcmVxdWVuY3k6IHs6LjZmfSBNSHonLmZvcm1hdChwYXJhbSAv
        IDFlNikpCiAgICAgICAgcmFkaW8uc2V0RnJlcXVlbmN5KFNPQVBZX1NEUl9S
        WCwgMCwgcGFyYW0pCiAgICBlbGlmIGNvbW1hbmQgPT0gMHgwMjoKICAgICAg
        ICBpbmZvKCdzZXRfc2FtcGxlX3JhdGU6IHt9IEh6Jy5mb3JtYXQocGFyYW0p
        KQogICAgICAgIHJhZGlvLnNldFNhbXBsZVJhdGUoU09BUFlfU0RSX1JYLCAw
        LCBwYXJhbSkKICAgIGVsaWYgY29tbWFuZCA9PSAweDAzOgogICAgICAgIGlu
        Zm8oJ3NldF9nYWluX21vZGU6IHt9Jy5mb3JtYXQocGFyYW0pKQogICAgICAg
        IHJhZGlvLnNldEdhaW5Nb2RlKFNPQVBZX1NEUl9SWCwgMCwgbm90IHBhcmFt
        KTsKICAgIGVsaWYgY29tbWFuZCA9PSAweDA0OgogICAgICAgIHBhcmFtID0g
        cGFyYW0gLyAxMAogICAgICAgIGluZm8oJ3NldF9nYWluOiB7Oi4xZn0nLmZv
        cm1hdChwYXJhbSkpCiAgICAgICAgcmFkaW8uc2V0R2FpbihTT0FQWV9TRFJf
        UlgsIDAsIHBhcmFtKTsKICAgIGVsc2U6CiAgICAgICAgaW5mbygndW1pbXBs
        ZW1lbnRlZDogezouMWZ9Jy5mb3JtYXQoY29tbWFuZCkpCgoKZGVmIHRjcF9z
        ZXJ2ZXIoZGF0YSk6CiAgICBpZiBhcmdzLnJ0bHRjcDoKICAgICAgICBkYXRh
        ID0gKGRhdGEgKiAxMjggKyAxMjgpLmFzdHlwZSgnQicpCiAgICByZWFkYWJs
        ZSwgd3JpdGFibGUsIGV4Y2VwdGlvbmFsID0gc2VsZWN0LnNlbGVjdChzb2Nr
        X2xpc3QsIHNvY2tfbGlzdCwgc29ja19saXN0LCAwKQogICAgZm9yIHNvY2sg
        aW4gc29ja19saXN0OgogICAgICAgIGlmIHNvY2sgaW4gZXhjZXB0aW9uYWw6
        CiAgICAgICAgICAgIGNsb3NlX2Nvbm4oc29jaykKICAgIGZvciBzb2NrIGlu
        IHNvY2tfbGlzdDoKICAgICAgICBpZiBzb2NrIGluIHdyaXRhYmxlOgogICAg
        ICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBzb2NrLnNlbmRhbGwoZGF0
        YSkKICAgICAgICAgICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgICAgICAg
        ICBjbG9zZV9jb25uKHNvY2spCiAgICBmb3Igc29jayBpbiBzb2NrX2xpc3Q6
        CiAgICAgICAgaWYgc29jayBpbiByZWFkYWJsZToKICAgICAgICAgICAgaWYg
        c29jayA9PSBzb2NrX3NlcnZlcjoKICAgICAgICAgICAgICAgIGNvbm4sIGNs
        aWVudF9hZGRyZXNzID0gc29jay5hY2NlcHQoKQogICAgICAgICAgICAgICAg
        b3Blbl9jb25uKGNvbm4sIGNsaWVudF9hZGRyZXNzKQogICAgICAgICAgICAg
        ICAgaWYgYXJncy5ydGx0Y3A6CiAgICAgICAgICAgICAgICAgICAgdHVuZXJf
        bnVtYmVyID0gNSAjIFI4MjBUCiAgICAgICAgICAgICAgICAgICAgdHVuZXJf
        Z2FpbnMgPSAyOSAjIFI4MjBUCiAgICAgICAgICAgICAgICAgICAgZG9uZ2xl
        X2luZm8gPSBzdHJ1Y3QucGFjaygnPjRzSUknLCBiJ1JUTDAnLCB0dW5lcl9u
        dW1iZXIsIHR1bmVyX2dhaW5zKQogICAgICAgICAgICAgICAgICAgIGNvbm4u
        c2VuZGFsbChkb25nbGVfaW5mbykKICAgICAgICAgICAgZWxzZToKICAgICAg
        ICAgICAgICAgIGJ1ZiA9IHNvY2sucmVjdihjb21tYW5kX3NpemUpCiAgICAg
        ICAgICAgICAgICB0Y3BfY29tbWFuZChidWYpCgoKZGVmIGluaXRfc2VydmVy
        KCk6CiAgICBnbG9iYWwgc29ja19zZXJ2ZXIsIHNvY2tfbGlzdAogICAgc29j
        ayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NL
        X1NUUkVBTSkKICAgIHNvY2suc2V0c29ja29wdChzb2NrZXQuU09MX1NPQ0tF
        VCwgc29ja2V0LlNPX1JFVVNFQUREUiwgMSkKICAgIHNvY2suYmluZCgoYXJn
        cy5ob3N0LCBhcmdzLnBvcnQpKQogICAgc29jay5saXN0ZW4oKQogICAgc29j
        a19saXN0ID0gWyBzb2NrIF0KICAgIHNvY2tfc2VydmVyID0gc29jawoKCmRl
        ZiByYWRpb19zdGFydCgpOgogICAgZ2xvYmFsIHJhdGUsIHRpbWVmaWxlLCBz
        YW1wbGVzX3RvdGFsCiAgICBpZiBub3QgYXJncy5ub3NlcnZlcjogCiAgICAg
        ICAgaW5pdF9zZXJ2ZXIoKQogICAgcmF0ZSA9IHJhZGlvLmdldFNhbXBsZVJh
        dGUoU09BUFlfU0RSX1JYLCAwKQogICAgZGF0YSA9IG5wLmFycmF5KFswXSAq
        IGFyZ3MucGFja2V0X3NpemUgKiAyLCBucC5mbG9hdDMyKQogICAgc3RyZWFt
        ID0gcmFkaW8uc2V0dXBTdHJlYW0oU09BUFlfU0RSX1JYLCBTT0FQWV9TRFJf
        Q0YzMikKICAgIHJhZGlvLmFjdGl2YXRlU3RyZWFtKHN0cmVhbSkgCiAgICBz
        YW1wbGVzX3RvdGFsID0gMAogICAgcGVha19sZXZlbCA9IDAKICAgIHNhbXBs
        ZV9udW0gPSAwCiAgICBvdXRmaWxlID0gTm9uZQogICAgdHJ5OgogICAgICAg
        IHdoaWxlIG5vdCBraWxsZWQgYW5kIG5vdCBmYXRhbDoKICAgICAgICAgICAg
        cmFkaW8ucmVhZFN0cmVhbShzdHJlYW0sIFtkYXRhXSwgYXJncy5wYWNrZXRf
        c2l6ZSkKICAgICAgICAgICAgaWYgbm90IHBhdXNlZDoKICAgICAgICAgICAg
        ICAgIGlmIG5vdCBvdXRmaWxlOgogICAgICAgICAgICAgICAgICAgIG91dGZp
        bGUsIHRpbWVmaWxlID0gb3Blbl9maWxlcygpCiAgICAgICAgICAgICAgICBz
        YW1wbGVzX3RvdGFsICs9IGFyZ3MucGFja2V0X3NpemUKICAgICAgICAgICAg
        ICAgIG91dGZpbGUud3JpdGUoZGF0YSkKICAgICAgICAgICAgaWYgbm90IGFy
        Z3Mubm9zZXJ2ZXI6CiAgICAgICAgICAgICAgICB0Y3Bfc2VydmVyKGRhdGEp
        CgogICAgICAgICAgICAjIHBlYWsgbWV0ZXIKICAgICAgICAgICAgcGVha19s
        ZXZlbCA9IG1heChwZWFrX2xldmVsLCBhYnMoZGF0YS5taW4oKSksIGFicyhk
        YXRhLm1heCgpKSkKICAgICAgICAgICAgc2FtcGxlX251bSArPSBhcmdzLnBh
        Y2tldF9zaXplCiAgICAgICAgICAgIGlmIHNhbXBsZV9udW0gPiByYXRlICog
        YXJncy5yZWZyZXNoOgogICAgICAgICAgICAgICAgcmFkaW9fcGVhayhwZWFr
        X2xldmVsKQogICAgICAgICAgICAgICAgcGVha19sZXZlbCA9IDAKICAgICAg
        ICAgICAgICAgIHNhbXBsZV9udW0gPSAwCiAgICBleGNlcHQgKEtleWJvYXJk
        SW50ZXJydXB0LCBTeXN0ZW1FcnJvcikgYXMgZToKICAgICAgICBpbmZvKGYi
        RXhjZXB0aW9uIHJhZGlvX3N0YXJ0KCk6IHtlfSIpCiAgICAgICAgdGltZS5z
        bGVlcChhcmdzLnJlc3RhcnRfc2Vjb25kcykKICAgIGlmIG5vdCBhcmdzLm5v
        c2VydmVyOiAKICAgICAgICBjbG9zZV9zZXJ2ZXIoKQogICAgY2xvc2VfZmls
        ZShvdXRmaWxlLCAiYXVkaW8iKQogICAgdGltZWZpbGUgPSBjbG9zZV9maWxl
        KHRpbWVmaWxlLCAidGltZSIpCiAgICBjbG9zZV9zdHJlYW0oc3RyZWFtKQog
        ICAgaWYgZmF0YWw6CiAgICAgICAgaW5mbygiRmF0YWwgY29tbWFuZCBnaXZl
        biwga2lsbGluZyBwcm9jZXNzIikKICAgICAgICBzeXMuZXhpdCgxKQoKCmlm
        IF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBhcmdzID0gcGFyc2VyLnBh
        cnNlX2FyZ3MoKQogICAgbWFpbigpCgo=


  - become: yes
    copy:
      mode: 0755
      dest: /usr/local/bin/mqclient
      content: !!binary |
        IyEvdXNyL2Jpbi9weXRob24zCgppbXBvcnQgc3lzCmltcG9ydCBhcmdwYXJz
        ZQppbXBvcnQgcGFoby5tcXR0LmNsaWVudCBhcyBtcXR0CgpwYXJzZXIgPSBh
        cmdwYXJzZS5Bcmd1bWVudFBhcnNlcigKICAgIGZvcm1hdHRlcl9jbGFzcz1h
        cmdwYXJzZS5Bcmd1bWVudERlZmF1bHRzSGVscEZvcm1hdHRlcikKcGFyc2Vy
        LmFkZF9hcmd1bWVudCgiLS1icm9rZXIiLCBkZWZhdWx0PSIxMjcuMC4wLjEi
        LCBoZWxwPSdicm9rZXIgaG9zdCcpCnBhcnNlci5hZGRfYXJndW1lbnQoIi0t
        cG9ydCIsIGRlZmF1bHQ9MTg4MywgaGVscD0nYnJva2VyIHBvcnQnKQpwYXJz
        ZXIuYWRkX2FyZ3VtZW50KCItLWtlZXBhbGl2ZSIsIGRlZmF1bHQ9NjAsIGhl
        bHA9J2Jyb2tlciBrZWVwIGFsaXZlJykKcGFyc2VyLmFkZF9hcmd1bWVudCgi
        LS10b3BpYyIsIGRlZmF1bHQ9ImYvdHgiLCBoZWxwPSdjb21tYW5kIHRvcGlj
        JykKCmRlZiBnZW5fdG9waWMobmFtZT1Ob25lKToKICAgIGQgPSBhcmdzLnRv
        cGljLnNwbGl0KCcvJylbOi0xXQogICAgaWYgbmFtZSBpcyBub3QgTm9uZToK
        ICAgICAgICBkLmFwcGVuZChuYW1lKQogICAgcmV0dXJuICcvJy5qb2luKGQp
        CgpkZWYgb25fY29ubmVjdChjbGllbnQsIHVzZXJkYXRhLCBmbGFncywgcmMp
        OgogICAgY2xpZW50LnN1YnNjcmliZShnZW5fdG9waWMoJyMnKSkKCmRlZiBv
        bl9tZXNzYWdlKGNsaWVudCwgdXNlcmRhdGEsIG1zZyk6CiAgICBwcmludCht
        c2cudG9waWMgKyAiICIgKyBtc2cucGF5bG9hZC5kZWNvZGUoJ2xhdGluJykp
        CgpkZWYgbWFpbigpOgogICAgY2xpZW50ID0gbXF0dC5DbGllbnQoKQogICAg
        Y2xpZW50Lm9uX2Nvbm5lY3QgPSBvbl9jb25uZWN0CiAgICBjbGllbnQub25f
        bWVzc2FnZSA9IG9uX21lc3NhZ2UKICAgIGNsaWVudC5jb25uZWN0KGFyZ3Mu
        YnJva2VyLCBhcmdzLnBvcnQsIGFyZ3Mua2VlcGFsaXZlKQogICAgY2xpZW50
        Lmxvb3Bfc3RhcnQoKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBsaW5lID0g
        bmV4dChzeXMuc3RkaW4pLnJzdHJpcCgpCiAgICAgICAgY2xpZW50LnB1Ymxp
        c2goYXJncy50b3BpYywgbGluZSkgCgppZiBfX25hbWVfXyA9PSAnX19tYWlu
        X18nOgogICAgYXJncyA9IHBhcnNlci5wYXJzZV9hcmdzKCkKICAgIG1haW4o
        KQoKCg==



  # output directory

  - become: yes
    file: path={{ fs_path }} state=directory owner={{ user }} group={{ user }}

  - become: yes
    copy:
      dest: /lib/systemd/system/mqsoapy.service
      content: |
        [Service]
        ExecStart=/usr/bin/python3 -u /usr/local/bin/mqsoapy --wrap --rtltcp --pause --output {{ fs_path }}/out
        # WorkingDirectory={{ fs_path }}
        User=george
        Restart=on-failure
        RestartSec=10s
        [Install]
        WantedBy=multi-user.target

  - become: yes
    shell: |
      sudo systemctl enable mqsoapy
      sudo systemctl restart mqsoapy


